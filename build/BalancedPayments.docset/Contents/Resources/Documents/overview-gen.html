<div>

<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta charset="utf-8">
<title>Balanced</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="static/css/styles.css" rel="stylesheet">
<link href="static/css/pygments.css" rel="stylesheet">
<div id="content"><div class="container content" id="overview-content">
    <div class="row">

        <!-- The side bar menu -->
        

        <!-- The actual overview content -->
        <div id="context-content" class="span20 offset1">
            
  <div class="toctree-wrapper compound">
<span id="document-introduction"></span><section id="overview"><h1>Overview<a class="headerlink" href="#overview" title="Permalink to this headline"></a>
</h1>
<div class="overview-large">
<p>Balanced is a payments company dedicated to increasing the world's
economic output. To do this, we've decided to work with online
marketplaces and crowdfunding platforms to help them create new forms of commerce.
We&acirc;&#128;&#153;ve built a white-labeled API and open sourced dashboard to help them
do this. And while we really like working with marketplaces and
crowdfunding platforms, Balanced can be used for e-commerce models of all types.</p>
<p>We&acirc;&#128;&#153;ve been processing live transactions since October, 2010 and have a
history of working closely with our customers to solve their problems,
specifically those related to multi-party transactions. For example,
we&acirc;&#128;&#153;re in an <a class="reference external" href="http://blog.gittip.com/post/28351995405/open-partnerships">open partnership</a> with <a class="reference external" href="http://gittip.com">Gittip</a> after volunteering code
and expertise to help them <a class="reference external" href="https://github.com/gittip/www.gittip.com/issues/67">mitigate the risks of running a
marketplace</a>. To date, Balanced has contributed to Gittip&acirc;&#128;&#153;s <a class="reference external" href="https://github.com/gittip/www.gittip.com/pull/137">payments
infrastructure</a>, <a class="reference external" href="https://github.com/gittip/www.gittip.com/issues/66#issuecomment-7439689">visual design</a>, and <a class="reference external" href="https://github.com/gvenkataraman/www.gittip.com/commit/ceb88e6f5e1eb7ae931cf2921866beccb49381b5">fraud preventions systems</a>.</p>
<p>Balanced believes in openness and transparency, so, despite being a
payments company, we try to discuss as much of our product development
decisions in public as possible. We&acirc;&#128;&#153;ve even <a class="reference external" href="https://github.com/balanced/balanced-api/issues/48">discussed pricing
decisions</a> publicly with our customers.</p>
</div>
<div class="integration">
<div class="copy-box">
Start Integrating</div>
</div>
<div class="span6">
<div class="header3">
Tutorials</div>
<div class="box box-block box-blue">
<span class="icon icon-page"></span>
<a class="reference internal" href="overview.html#getting-started-collecting-card-info"><em>Collect credit card info</em></a>
</div>
<div class="box box-block box-blue">
<span class="icon icon-page"></span>
<a class="reference internal" href="overview.html#getting-started-charging-cards"><em>Charge a credit card</em></a>
</div>
<div class="box box-block box-blue">
<span class="icon icon-page"></span>
<a class="reference internal" href="overview.html#getting-started-collecting-bank-info"><em>Collect bank account info</em></a>
</div>
<div class="box box-block box-blue">
<span class="icon icon-page"></span>
<a class="reference internal" href="overview.html#getting-started-credit-bank-account"><em>Credit bank account</em></a>
</div>
</div>
<div class="span6">
<div class="header3">
Form Building</div>
<div class="box box-block box-turquoise">
<span class="icon icon-page"></span>
<a class="reference external" href="#collecting-credit-card-information">Sample credit card form</a>
</div>
<div class="box box-block box-turquoise">
<span class="icon icon-page"></span>
<a class="reference external" href="#collect-bank-account-info">Sample bank account form</a>
</div>
</div>
<div class="span6">
<div class="header3">
Testing</div>
<div class="box box-block box-purple">
<span class="icon icon-page"></span>
<a class="reference external" href="#test-credit-card-numbers">Test credit card numbers</a>
</div>
<div class="box box-block box-purple">
<span class="icon icon-page"></span>
<a class="reference external" href="#test-bank-account-numbers">Test bank account numbers</a>
</div>
</div>
<div class="clear">
</div>
<hr>
<section id="client-libraries"><span id="overview-use-cases"></span><h2>Client Libraries<a class="headerlink" href="#client-libraries" title="Permalink to this headline"></a>
</h2>
<p>Balanced attempts very hard to write idiomatic code for all it's API libraries
and we pride ourselves in an extensive test suite for every client that
demonstrates almost every single method / function executed for your
convenience.</p>
<p>We find that this is the best way to use the client libraries. If you encounter
and issue, please file a github issue and get in touch through one our
many <a class="reference internal" href="overview.html#overview-support"><em>support channels</em></a>.</p>
<table border="1" class="table table-hover docutils">
<colgroup>
<col width="23%">
<col width="26%">
<col width="28%">
<col width="23%">
</colgroup>
<thead valign="bottom"><tr class="row-odd">
<th class="head">Language / Platform</th>
<th class="head">Repository</th>
<th class="head">Tests</th>
<th class="head">Primary Contributor</th>
</tr></thead>
<tbody valign="top">
<tr class="row-even">
<td>python</td>
<td><a class="reference external" href="https://github.com/balanced/balanced-python">balanced-python</a></td>
<td><a class="reference external" href="https://github.com/balanced/balanced-python/tree/master/tests">balanced-python tests</a></td>
<td>Balanced</td>
</tr>
<tr class="row-odd">
<td>ruby</td>
<td><a class="reference external" href="https://github.com/balanced/balanced-ruby">balanced-ruby</a></td>
<td><a class="reference external" href="https://github.com/balanced/balanced-ruby/tree/master/spec">balanced-ruby tests</a></td>
<td>Balanced</td>
</tr>
<tr class="row-even">
<td>php</td>
<td><a class="reference external" href="https://github.com/balanced/balanced-php">balanced-php</a></td>
<td><a class="reference external" href="https://github.com/balanced/balanced-php/tree/master/tests">balanced-php tests</a></td>
<td>Balanced</td>
</tr>
<tr class="row-odd">
<td>php (symfony2 bundle)</td>
<td><a class="reference external" href="https://github.com/jeremymarc/JmBalancedPaymentBundle">JmBalancedPaymentBundle</a></td>
<td><a class="reference external" href="https://github.com/jeremymarc/JmBalancedPaymentBundle/tree/master/Tests">JmBalancedPaymentBundle Tests</a></td>
<td><a class="reference external" href="https://twitter.com/jeremymarc">Jeremy Marc</a></td>
</tr>
<tr class="row-even">
<td>java</td>
<td><a class="reference external" href="https://github.com/balanced/balanced-java">balanced-java</a></td>
<td><a class="reference external" href="https://github.com/balanced/balanced-java/tree/master/src/test">balanced-java tests</a></td>
<td>Balanced</td>
</tr>
<tr class="row-odd">
<td>iOS</td>
<td><a class="reference external" href="https://github.com/balanced/balanced-ios">balanced-ios</a></td>
<td><a class="reference external" href="https://github.com/balanced/balanced-ios/tree/master/BalancedTests">balanced-ios tests</a></td>
<td><a class="reference external" href="http://unfiniti.com">Ben Mills (Remear)</a></td>
</tr>
<tr class="row-even">
<td>perl</td>
<td><a class="reference external" href="https://github.com/Crowdtilt/Business-BalancedPayments">Business-BalancedPayments</a></td>
<td><a class="reference external" href="https://github.com/Crowdtilt/Business-BalancedPayments/tree/master/t">Business-BalancedPayments tests</a></td>
<td><a class="reference external" href="http://crowdtilt.com">Crowdtilt.com</a></td>
</tr>
</tbody>
</table></section><hr>
<section id="use-cases"><h2>Use Cases<a class="headerlink" href="#use-cases" title="Permalink to this headline"></a>
</h2>
<div class="header3 mb-ten">
Marketplaces</div>
<p>Balanced is most often used to power payments for online and mobile
marketplaces -- any platform facilitating payments between buyers and
sellers. For example, <a class="reference external" href="http://kitchit.com">kitchit</a>, <a class="reference external" href="http://copious.com">copious</a>, <a class="reference external" href="http://zaarly.com">zaarly</a>, <a class="reference external" href="http://visual.ly">visual.ly</a>,
and many others are connecting Balanced Processing and Balanced Payouts
to charge a buyer&acirc;&#128;&#153;s credit card on behalf of a seller.</p>
<p>Some customers have even implemented a shopping cart checkout flow where
a single buyer can buy from many sellers with a single transaction. And
holding the funds with Balanced between Payouts and Processing can allow
the marketplace to implement an escrow-like functionality.</p>
<div class="header3 mb-ten">
Crowd-Funding</div>
<p>Balanced is commonly used to power payments for crowd-funding and group
purchasing platforms. For example, <a class="reference external" href="http://crowdtilt.com">crowdtilt</a>, <a class="reference external" href="http://wanderable.com">wanderable</a>,
<a class="reference external" href="http://gittip.com">gittip</a>, and many others are connecting Balanced Processing and
Balanced Payouts to charge many buyers&acirc;&#128;&#153; credit cards on behalf of a
single seller.</p>
<div class="header3 mb-ten">
Vendor Payments</div>
<p>Balanced Payouts is used by many businesses that need to pay their
sellers or vendors for supplies and services rendered.</p>
<div class="header3 mb-ten">
E-Commerce</div>
<p>Balanced Processing is used by a merchants to simply charge buyers for
items they sell directly.</p>
</section><hr>
<section id="github-discussions"><span id="overview-github-issues"></span><h2>Github Discussions<a class="headerlink" href="#github-discussions" title="Permalink to this headline"></a>
</h2>
<p>We actively and publicly discuss feature requests and product decisions
with our community on <a class="reference external" href="https://github.com/balanced/balanced-api/issues">github</a>. We&acirc;&#128;&#153;d love to hear from you.</p>
</section><hr>
<section id="support"><span id="overview-support"></span><h2>Support<a class="headerlink" href="#support" title="Permalink to this headline"></a>
</h2>
<p>We respond to support requests and questions through several channels
including:</p>
<ul class="simple">
<li>
<a class="reference external" href="http://webchat.freenode.net/?channels=balanced&amp;uio=MTE9OTIaf">IRC</a> for real-time answers to technical support questions</li>
<li>
<a class="reference external" href="https://stackoverflow.com/questions/tagged/balanced-payments">Stackoverflow</a> for technical questions</li>
<li>
<a class="reference external" href="https://quora.com/balanced">Quora</a> for product and business questions</li>
<li>Email: <a class="reference external" href="mailto:support%40balancedpayments.com">support<span>@</span>balancedpayments<span>.</span>com</a>
</li>
</ul>
<p>Follow <a class="reference external" href="https://twitter.com/balancedstatus">@balancedstatus</a> or check out <a class="reference external" href="https://status.balancedpayments.com/">status.balancedpayments.com</a>
for real-time status updates on the API, balanced.js, and Balanced&acirc;&#128;&#153;s
dashboard.</p>
<p>Join the Balanced <a class="reference external" href="https://www.balancedpayments.com/community">community</a> and follow us on <a class="reference external" href="https://twitter.com/balanced">Twitter</a>.</p>
</section><hr>
<section id="certified-developers"><h2>Certified Developers<a class="headerlink" href="#certified-developers" title="Permalink to this headline"></a>
</h2>
<p>We've partnered with <a class="reference external" href="https://apixchange.com/">APIXchange</a> -- a marketplace for custom API development
projects -- to help companies looking for assistance with their Balanced API
integration find a quality Balanced certified developer.</p>
<p>Create a project on <a class="reference external" href="https://apixchange.com/">APIXchange</a> to get started:</p>
<a class="reference external image-reference" href="https://apixchange.com/landing/balanced"><img alt="https://apixchange.com/static/img/embed-button.png" src="https://apixchange.com/static/img/embed-button.png"></a>
<p>If you'd like to find a developer to help with your Balanced integration
outside of APIXchange, please post your criteria on <a class="reference external" href="https://github.com/balanced/balanced-api/issues/315">this Github issue</a>.</p>
</section></section><hr>
<span id="document-getting_started"></span><section id="getting-started"><span id="id1"></span><h1>Getting Started<a class="headerlink" href="#getting-started" title="Permalink to this headline"></a>
</h1>
<hr>
<section id="obtain-a-test-marketplace"><span id="getting-started-obtain-test-marketplace"></span><h2>Obtain a Test Marketplace<a class="headerlink" href="#obtain-a-test-marketplace" title="Permalink to this headline"></a>
</h2>
<p>Visit <a class="reference external" href="https://www.balancedpayments.com">https://www.balancedpayments.com</a> and click the try it out button. This
creates a new test marketplace for immediate use.</p>
<p>Use your API key to start interacting with the Balanced API.</p>
<p>Click "Demo Dashboard" to view your new test marketplace with some sample data.</p>
<div class="alert alert-tab admonition note">
note</div>
<div class="alert alert-gray">
Be sure to claim your account by clicking the user icon in the top right corner of
the dashboard and selecting "Claim account". Enter your email address and a
password to permanently claim that dashboard as your own.</div>
</section><hr>
<section id="obtain-a-production-marketplace"><span id="getting-started-obtain-prod-marketplace"></span><h2>Obtain a Production Marketplace<a class="headerlink" href="#obtain-a-production-marketplace" title="Permalink to this headline"></a>
</h2>
<p>To obtain a production marketplace:</p>
<ul class="simple">
<li>Sign into your dashboard account.</li>
<li>Visit <a class="reference external" href="https://dashboard.balancedpayments.com/#/marketplaces">https://dashboard.balancedpayments.com/#/marketplaces</a>
</li>
<li>Where you see "Not transacting yet? Register for production access", click
the register button.</li>
<li>Choose if you are applying for a production marketplace as a person or a business.</li>
<li>Fill out the form.</li>
<li>Accept the <a class="reference external" href="https://www.balancedpayments.com/terms/">Terms &amp; Conditions</a>,
<a class="reference external" href="https://www.balancedpayments.com/terms/marketplaceagreement">Marketplace Agreement</a>,
and <a class="reference external" href="https://www.balancedpayments.com/privacy">Privacy Policy</a>.</li>
<li>Submit the form.</li>
<li>After 1-2 days, find the verification amounts on your bank statement.</li>
<li>Via the Dashboard go to your production marketplace settings page.</li>
<li>Click on your marketplace bank account.</li>
<li>Click the confirm verification button.</li>
<li>Enter the verification amounts and click the confirm button.</li>
</ul>
<blockquote>
<div>
<div class="line-block">
<div class="line"><br></div>
</div>
</div>
</blockquote>
<div class="alert alert-tab admonition note">
note</div>
<div class="alert alert-gray">
Don't forget to update your application to use your production API key and
production marketplace URI before you begin transacting in your production marketplace.</div>
</section><hr>
<section id="balanced-js"><h2>Balanced.js<a class="headerlink" href="#balanced-js" title="Permalink to this headline"></a>
</h2>
<p><span class="docutils literal"><code>balanced.js</code></span> is essential in ensuring that you're PCI compliant. Sensitive
data never touches your servers and as a result, the burden of PCI compliance
shifts to Balanced, which is <a class="reference external" href="http://www.visa.com/splisting/searchGrsp.do?companyNameCriteria=Pound%20Payments">PCI-DSS Level 1 Compliant</a>.</p>
<div>
<ol class="arabic simple">
<li>Use <span class="docutils literal"><code>balanced.js</code></span> to send sensitive information to Balanced</li>
<li>Use the <span class="docutils literal"><code>uri</code></span>, returned by Balanced, as the token representing
the sensitive information</li>
<li>Associate that token to a customer</li>
<li>Debit that customer</li>
</ol>
</div>
<p>We're putting this here as we're going to reference it in the <a class="reference internal" href="overview.html#payouts"><em>Balanced Payouts</em></a>
and the <a class="reference internal" href="overview.html#processing"><em>Processing</em></a> tutorials.</p>
<section id="including-and-initializing-balanced-js"><h3>Including and Initializing <span class="docutils literal"><code>balanced.js</code></span><a class="headerlink" href="#including-and-initializing-balanced-js" title="Permalink to this headline"></a>
</h3>
<div class="alert alert-tab admonition note">
note</div>
<div class="alert alert-gray">
This may not work on very old browsers. For more information on how to
support older browsers, <a class="reference external" href="http://www.quirksmode.org/js/placejs.html">quirksmode</a> provides a tutorial on how to get
javascript <span class="docutils literal"><code>&lt;script&gt;</code></span> includes to play nicely.</div>
<div id="getting-started-including-balanced-js">
<p>Including <span class="docutils literal"><code>balanced.js</code></span></p>
<div class="highlight-html">
<div class="highlight"><pre><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span> <span class="na">src=</span><span class="s">"https://js.balancedpayments.com/v1/balanced.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
</pre></div>
</div>
</div>
<div id="getting-started-initializing-balanced-js">
<p>Initializing <span class="docutils literal"><code>balanced.js</code></span></p>
<p>In a separate script tag, after you've
<a class="reference internal" href="overview.html#getting-started-including-balanced-js"><em>included balanced.js</em></a>,
set your marketplace uri. This essentially acts as your public key and it's
OK to freely share this with anyone.</p>
<div class="highlight-html">
<div class="highlight"><pre><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;</span>
    <span class="nx">balanced</span><span class="p">.</span><span class="nx">init</span><span class="p">(</span><span class="s1">'${REPLACE_THIS_WITH_YOUR_MARKETPLACE_URI}'</span><span class="p">);</span>
<span class="nt">&lt;/script&gt;</span>
</pre></div>
</div>
<p>Example:</p>
<div class="highlight-html">
<div class="highlight"><pre><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;</span>
    <span class="nx">balanced</span><span class="p">.</span><span class="nx">init</span><span class="p">(</span><span class="s1">'/v1/marketplaces/TEST-MP5JtbXVDZkSGruOJyNasPqy'</span><span class="p">);</span>
<span class="nt">&lt;/script&gt;</span>
</pre></div>
</div>
<p>You can find your API key secret and marketplace URI from your
<a class="reference external" href="https://dashboard.balancedpayments.com/">dashboard</a>.</p>
</div>
</section></section><hr>
<section id="collecting-credit-card-information"><span id="getting-started-collecting-card-info"></span><h2>Collecting credit card information<a class="headerlink" href="#collecting-credit-card-information" title="Permalink to this headline"></a>
</h2>
<div class="mb-large">
<div class="header3">
<p>Functional final result of tutorial:</p>
<div class="span7">
<div class="box box-block box-blue">
<span class="icon icon-cloud"></span>
<a class="reference external" href="http://jsfiddle.net/balanced/ZwhrA/">JSFiddle - Tokenize credit cards</a>
</div>
</div>
</div>
</div>
<div class="clear mb-large">
</div>
<div class="alert alert-tab admonition note">
note</div>
<div class="alert alert-gray">
Throughout this tutorial, we're using <a class="reference external" href="http://www.jquery.com">jQuery</a> for brevity, but
<span class="docutils literal"><code>balanced.js</code></span> has no such dependency itself.</div>
<ol class="arabic">
<li>
<p class="first">Collect all the information from your form:</p>
<div class="highlight-javascript">
<div class="highlight"><pre><span class="kd">var</span> <span class="nx">$form</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">'#credit-card-form'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">creditCardData</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">card_number</span><span class="o">:</span> <span class="nx">$form</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">'.cc-number'</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>
    <span class="nx">expiration_month</span><span class="o">:</span> <span class="nx">$form</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">'.cc-em'</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>
    <span class="nx">expiration_year</span><span class="o">:</span> <span class="nx">$form</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">'.cc-ey'</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>
    <span class="nx">security_code</span><span class="o">:</span> <span class="nx">$form</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">'.cc-csc'</span><span class="p">).</span><span class="nx">val</span><span class="p">()</span>
 <span class="p">};</span>
</pre></div>
</div>
</li>
<li>
<p class="first">Invoke the <a class="reference internal" href="overview.html#balanced.card.create" title="balanced.card.create"><span class="xref js js-func docutils literal"><code>balanced.card.create()</code></span></a> function with the collected information.
Balanced will return a persistence-safe token, the <span class="docutils literal"><code>uri</code></span>, representing
the resource.</p>
<p>Here's an example, demonstrating this:</p>
<div class="highlight-javascript">
<div class="highlight"><pre><span class="nx">balanced</span><span class="p">.</span><span class="nx">card</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">creditCardData</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">status</span><span class="p">);</span>
  <span class="cm">/*</span>
<span class="cm">    response.data:</span>
<span class="cm">      Contains the body of the card resource, which you can find</span>
<span class="cm">      in the API reference.</span>

<span class="cm">      This data is an object, i.e. hash, that can be identified by</span>
<span class="cm">      its uri field. You may store this uri in your data store (e.g.</span>
<span class="cm">      postgresql, mysql, mongodb, etc) since it's perfectly safe and</span>
<span class="cm">      can only be retrieved by your secret key.</span>

<span class="cm">      More on this in the API reference.</span>
<span class="cm">   */</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
</div>
<p id="getting-started-callback">The second parameter just did a dummy <span class="docutils literal"><code>alert()</code></span> for demonstration purposes,
but this function is actually the most important piece of the integration.</p>
<p>It is your Balanced response handler. It takes one parameter that
has three (3) properties which you can use to drive the interaction
with Balanced:</p>
<dl class="dl-horizontal docutils">
<dt><span class="docutils literal"><code>data</code></span></dt>
<dd>
<div class="first last line-block">
<div class="line">An object representing a tokenized resource (card or bank account).</div>
</div>
</dd>
<dt><span class="docutils literal"><code>error</code></span></dt>
<dd>
<div class="first last line-block">
<div class="line">Details of the error, if any.</div>
</div>
</dd>
<dt><span class="docutils literal"><code>status</code></span></dt>
<dd>
<div class="first last line-block">
<div class="line">The HTTP response code of the tokenization operation.</div>
</div>
</dd>
</dl>
<p>Here's a skeleton callback function that we can use to get started:</p>
<div class="highlight-javascript">
<div class="highlight"><pre><span class="kd">function</span> <span class="nx">callbackHandler</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
   <span class="k">switch</span> <span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">status</span><span class="p">)</span> <span class="p">{</span>
     <span class="k">case</span> <span class="mi">201</span><span class="o">:</span>
         <span class="c1">// WOO HOO! MONEY!</span>
         <span class="c1">// response.data.uri == URI of the bank account resource you</span>
         <span class="c1">// can store this card URI in your database</span>
         <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
         <span class="kd">var</span> <span class="nx">$form</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s2">"#credit-card-form"</span><span class="p">);</span>
         <span class="c1">// the uri is an opaque token referencing the tokenized card</span>
         <span class="kd">var</span> <span class="nx">cardTokenURI</span> <span class="o">=</span> <span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="s1">'uri'</span><span class="p">];</span>
         <span class="c1">// append the token as a hidden field to submit to the server</span>
         <span class="nx">$</span><span class="p">(</span><span class="s1">'&lt;input&gt;'</span><span class="p">).</span><span class="nx">attr</span><span class="p">({</span>
            <span class="nx">type</span><span class="o">:</span> <span class="s1">'hidden'</span><span class="p">,</span>
            <span class="nx">value</span><span class="o">:</span> <span class="nx">cardTokenURI</span><span class="p">,</span>
            <span class="nx">name</span><span class="o">:</span> <span class="s1">'balancedCreditCardURI'</span>
         <span class="p">}).</span><span class="nx">appendTo</span><span class="p">(</span><span class="nx">$form</span><span class="p">);</span>
         <span class="k">break</span><span class="p">;</span>
     <span class="k">case</span> <span class="mi">400</span><span class="o">:</span>
         <span class="c1">// missing field - check response.error for details</span>
         <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">error</span><span class="p">);</span>
         <span class="k">break</span><span class="p">;</span>
     <span class="k">case</span> <span class="mi">402</span><span class="o">:</span>
         <span class="c1">// we couldn't authorize the buyer's credit card</span>
         <span class="c1">// check response.error for details</span>
         <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">error</span><span class="p">);</span>
         <span class="k">break</span>
     <span class="k">case</span> <span class="mi">404</span><span class="o">:</span>
         <span class="c1">// your marketplace URI is incorrect</span>
         <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">error</span><span class="p">);</span>
         <span class="k">break</span><span class="p">;</span>
     <span class="k">case</span> <span class="mi">500</span><span class="o">:</span>
         <span class="c1">// Balanced did something bad, please retry the request</span>
         <span class="k">break</span><span class="p">;</span>
   <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>So, let's show that example on creating a card again, but this time with a
proper callback handler:</p>
<div class="highlight-javascript">
<div class="highlight"><pre><span class="kd">var</span> <span class="nx">$form</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">'#credit-card-form'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">creditCardData</span> <span class="o">=</span> <span class="p">{</span>
     <span class="nx">card_number</span><span class="o">:</span> <span class="nx">$form</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">'.cc-number'</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>
     <span class="nx">expiration_month</span><span class="o">:</span> <span class="nx">$form</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">'.cc-em'</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>
     <span class="nx">expiration_year</span><span class="o">:</span> <span class="nx">$form</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">'.cc-ey'</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>
     <span class="nx">security_code</span><span class="o">:</span> <span class="nx">$form</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">'.cc-csc'</span><span class="p">).</span><span class="nx">val</span><span class="p">()</span>
 <span class="p">};</span>

<span class="nx">balanced</span><span class="p">.</span><span class="nx">card</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">creditCardData</span><span class="p">,</span> <span class="nx">callbackHandler</span><span class="p">);</span>
</pre></div>
</div>
</li>
</ol>
<div class="clear">
</div>
</section><hr>
<section id="charge-a-credit-card"><span id="getting-started-charging-cards"></span><h2>Charge a credit card<a class="headerlink" href="#charge-a-credit-card" title="Permalink to this headline"></a>
</h2>
<p>Ok, so you've got the card token, referred to as the <span class="docutils literal"><code>uri</code></span> of the returned Card
resource.</p>
<p>Let's charge the card:</p>
<ol class="arabic">
<li>
<p class="first">First, let's create a customer to which we can associate a card:</p>
<div class="request">
<p>Request</p>


<div class="highlight-ruby">
<div class="highlight"><pre><span class="nb">require</span> <span class="s1">'balanced'</span>
<span class="no">Balanced</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s1">'ak-test-2KZfoLyijij3Y6OyhDAvFRF9tXzelBLpD'</span><span class="p">)</span>

<span class="n">customer</span> <span class="o">=</span> <span class="no">Balanced</span><span class="o">::</span><span class="no">Customer</span><span class="o">.</span><span class="n">new</span><span class="o">.</span><span class="n">save</span>
</pre></div>
</div>


</div>
</li>
<li>
<p class="first">Associate the token with the customer:</p>
<div class="request">
<p>Request</p>


<div class="highlight-ruby">
<div class="highlight"><pre><span class="nb">require</span> <span class="s1">'balanced'</span>
<span class="no">Balanced</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s1">'ak-test-2KZfoLyijij3Y6OyhDAvFRF9tXzelBLpD'</span><span class="p">)</span>

<span class="n">customer</span> <span class="o">=</span> <span class="no">Balanced</span><span class="o">::</span><span class="no">Customer</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">'/v1/customers/CU7gMTGKh2yGHYn1lUxH9STS'</span><span class="p">)</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">customer</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="s1">'/v1/marketplaces/TEST-MP4K6K0PWGyPtXL4LZ42sQSb/cards/CC7iFRCb5AvLuZ9qzIF0VMmA'</span><span class="p">)</span>
</pre></div>
</div>


</div>
</li>
<li>
<p class="first">Debit the customer:</p>
<div class="request">
<p>Request</p>


<div class="highlight-ruby">
<div class="highlight"><pre><span class="nb">require</span> <span class="s1">'balanced'</span>
<span class="no">Balanced</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s1">'ak-test-2KZfoLyijij3Y6OyhDAvFRF9tXzelBLpD'</span><span class="p">)</span>

<span class="n">customer</span> <span class="o">=</span> <span class="no">Balanced</span><span class="o">::</span><span class="no">Customer</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">'/v1/customers/CU6vs1tjxBtifgTuzKjCGtVS'</span><span class="p">)</span>
<span class="n">customer</span><span class="o">.</span><span class="n">debit</span><span class="p">(</span><span class="ss">:amount</span> <span class="o">=&gt;</span> <span class="mi">5000</span><span class="p">)</span>
</pre></div>
</div>


</div>
</li>
</ol>
<div class="clear mb-large">
</div>
<div class="alert alert-tab admonition note">
note</div>
<div class="alert alert-gray">
Balanced does NOT take its fees from your charges, instead it instruments
all operations that have occurred on the API and later invoices you. Read
<a class="reference internal" href="overview.html#invoicing-fees"><em>more about fees</em></a>.</div>
</section><hr>
<section id="collect-bank-account-info"><span id="getting-started-collecting-bank-info"></span><h2>Collect bank account info<a class="headerlink" href="#collect-bank-account-info" title="Permalink to this headline"></a>
</h2>
<div class="mb-large">
<div class="header3">
<p>Functional final result of tutorial:</p>
<div class="span8">
<div class="box box-block box-blue">
<span class="icon icon-cloud"></span>
<a class="reference external" href="http://jsfiddle.net/balanced/ZwhrA/">JSFiddle - Tokenize bank accounts</a>
</div>
</div>
</div>
</div>
<div class="clear mb-large">
</div>
<div class="alert alert-tab admonition note">
note</div>
<div class="alert alert-gray">
Throughout this tutorial, we're using <a class="reference external" href="http://www.jquery.com">jQuery</a> for brevity, but
<span class="docutils literal"><code>balanced.js</code></span> has no such dependency itself.</div>
<ol class="arabic">
<li>
<p class="first">Collect all the information from your form:</p>
<div class="highlight-javascript">
<div class="highlight"><pre><span class="kd">var</span> <span class="nx">$form</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">'#bank-account-form'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">bankAccountData</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">name</span><span class="o">:</span> <span class="nx">$form</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">'.ba-name'</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>
    <span class="nx">routing_number</span><span class="o">:</span> <span class="nx">$form</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">'.ba-rn'</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>
    <span class="nx">account_number</span><span class="o">:</span> <span class="nx">$form</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">'.ba-an'</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>
    <span class="nx">type</span><span class="o">:</span> <span class="nx">$form</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">'select'</span><span class="p">).</span><span class="nx">val</span><span class="p">()</span>
<span class="p">};</span>
</pre></div>
</div>
</li>
<li>
<p class="first">Invoke the <span class="xref js js-func docutils literal"><code>balanced.bankAccount.create()</code></span> function with the collected information.
Balanced will return a persistence-safe token, the <span class="docutils literal"><code>uri</code></span>, representing
the resource.</p>
<p>Here's an example, demonstrating this:</p>
<div class="highlight-javascript">
<div class="highlight"><pre><span class="nx">balanced</span><span class="p">.</span><span class="nx">bankAccount</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">bankAccountData</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">status</span><span class="p">);</span>
  <span class="cm">/*</span>
<span class="cm">    response.data:</span>
<span class="cm">      Contains the body of the bank account resource, which you can find</span>
<span class="cm">      in the API reference.</span>

<span class="cm">      This data is an object, i.e. hash, that can be identified by</span>
<span class="cm">      its uri field. You may store this uri in your data store (e.g.</span>
<span class="cm">      postgresql, mysql, mongodb, etc) since it's perfectly safe and</span>
<span class="cm">      can only be retrieved by your secret key.</span>

<span class="cm">      More on this in the API reference.</span>
<span class="cm">   */</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
</div>
<p>The second parameter just did a dummy <span class="docutils literal"><code>alert()</code></span> for demonstration purposes,
but this function is actually the most important piece of the integration.</p>
<p>It is your Balanced response handler. It takes one parameter that
has three (3) properties which you can use to drive the interaction
with Balanced:</p>
<dl class="dl-horizontal docutils">
<dt><span class="docutils literal"><code>data</code></span></dt>
<dd>
<div class="first last line-block">
<div class="line">An object representing a tokenized resource (card or bank account).</div>
</div>
</dd>
<dt><span class="docutils literal"><code>error</code></span></dt>
<dd>
<div class="first last line-block">
<div class="line">Details of the error, if any.</div>
</div>
</dd>
<dt><span class="docutils literal"><code>status</code></span></dt>
<dd>
<div class="first last line-block">
<div class="line">The HTTP response code of the tokenization operation.</div>
</div>
</dd>
</dl>
<p>Here's a skeleton callback function that we can use to get started:</p>
<div class="highlight-javascript">
<div class="highlight"><pre><span class="kd">function</span> <span class="nx">callbackHandler</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
   <span class="k">switch</span> <span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">status</span><span class="p">)</span> <span class="p">{</span>
     <span class="k">case</span> <span class="mi">201</span><span class="o">:</span>
         <span class="c1">// WOO HOO! MONEY!</span>
         <span class="c1">// response.data.uri == URI of the bank account resource you</span>
         <span class="c1">// should store this bank account URI to later credit it</span>
         <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
         <span class="kd">var</span> <span class="nx">$form</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s2">"#bank-account-form"</span><span class="p">);</span>
         <span class="c1">// the uri is an opaque token referencing the tokenized bank account</span>
         <span class="kd">var</span> <span class="nx">bank_account_uri</span> <span class="o">=</span> <span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="s1">'uri'</span><span class="p">];</span>
         <span class="c1">// append the token as a hidden field to submit to the server</span>
         <span class="nx">$</span><span class="p">(</span><span class="s1">'&lt;input&gt;'</span><span class="p">).</span><span class="nx">attr</span><span class="p">({</span>
            <span class="nx">type</span><span class="o">:</span> <span class="s1">'hidden'</span><span class="p">,</span>
            <span class="nx">value</span><span class="o">:</span> <span class="nx">bank_account_uri</span><span class="p">,</span>
            <span class="nx">name</span><span class="o">:</span> <span class="s1">'balancedBankAccountURI'</span>
         <span class="p">}).</span><span class="nx">appendTo</span><span class="p">(</span><span class="nx">$form</span><span class="p">);</span>
         <span class="nx">$form</span><span class="p">.</span><span class="nx">attr</span><span class="p">({</span><span class="nx">action</span><span class="o">:</span> <span class="nx">requestBinURL</span><span class="p">});</span>
         <span class="nx">$form</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="nx">submit</span><span class="p">();</span>
         <span class="k">break</span><span class="p">;</span>
     <span class="k">case</span> <span class="mi">400</span><span class="o">:</span>
         <span class="c1">// missing field - check response.error for details</span>
         <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">error</span><span class="p">);</span>
         <span class="k">break</span><span class="p">;</span>
     <span class="k">case</span> <span class="mi">402</span><span class="o">:</span>
         <span class="c1">// we couldn't authorize the buyer's credit card</span>
         <span class="c1">// check response.error for details</span>
         <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">error</span><span class="p">);</span>
         <span class="k">break</span>
     <span class="k">case</span> <span class="mi">404</span><span class="o">:</span>
         <span class="c1">// your marketplace URI is incorrect</span>
         <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">error</span><span class="p">);</span>
         <span class="k">break</span><span class="p">;</span>
     <span class="k">case</span> <span class="mi">500</span><span class="o">:</span>
         <span class="c1">// Balanced did something bad, please retry the request</span>
         <span class="k">break</span><span class="p">;</span>
   <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>So, let's show that example on creating a card again, but this time with a
proper callback handler:</p>
<div class="highlight-javascript">
<div class="highlight"><pre><span class="kd">var</span> <span class="nx">$form</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">'#bank-account-form'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">bankAccountData</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">name</span><span class="o">:</span> <span class="nx">$form</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">'.ba-name'</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>
    <span class="nx">routing_number</span><span class="o">:</span> <span class="nx">$form</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">'.ba-rn'</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>
    <span class="nx">account_number</span><span class="o">:</span> <span class="nx">$form</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">'.ba-an'</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>
    <span class="nx">type</span><span class="o">:</span> <span class="nx">$form</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">'select'</span><span class="p">).</span><span class="nx">val</span><span class="p">()</span>
<span class="p">};</span>

<span class="nx">balanced</span><span class="p">.</span><span class="nx">bankAccount</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">bankAccountData</span><span class="p">,</span> <span class="nx">responseCallbackHandler</span><span class="p">);</span>
</pre></div>
</div>
</li>
</ol></section><hr>
<section id="credit-a-bank-account"><span id="getting-started-credit-bank-account"></span><h2>Credit a bank account<a class="headerlink" href="#credit-a-bank-account" title="Permalink to this headline"></a>
</h2>
<p>After collecting the bank account information via balanced.js, you'll have
the bank account token, referred to as the <span class="docutils literal"><code>uri</code></span> of the returned BankAccount
resource.</p>
<p>Let's issue a credit to this bank account:</p>
<ol class="arabic">
<li>
<p class="first">First, create a customer to which the bank account can be associated:</p>
<div class="request">
<p>Request</p>


<div class="highlight-ruby">
<div class="highlight"><pre><span class="nb">require</span> <span class="s1">'balanced'</span>
<span class="no">Balanced</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s1">'ak-test-2KZfoLyijij3Y6OyhDAvFRF9tXzelBLpD'</span><span class="p">)</span>

<span class="n">customer</span> <span class="o">=</span> <span class="no">Balanced</span><span class="o">::</span><span class="no">Customer</span><span class="o">.</span><span class="n">new</span><span class="o">.</span><span class="n">save</span>
</pre></div>
</div>


</div>
</li>
<li>
<p class="first">Associate the token with the customer:</p>
<div class="request">
<p>Request</p>


<div class="highlight-ruby">
<div class="highlight"><pre><span class="nb">require</span> <span class="s1">'balanced'</span>
<span class="no">Balanced</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s1">'ak-test-2KZfoLyijij3Y6OyhDAvFRF9tXzelBLpD'</span><span class="p">)</span>

<span class="n">customer</span> <span class="o">=</span> <span class="no">Balanced</span><span class="o">::</span><span class="no">Customer</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">'/v1/customers/CU6n0viWQoT86ttbkCsPgV0Y'</span><span class="p">)</span>
<span class="n">customer</span><span class="o">.</span><span class="n">add_bank_account</span><span class="p">(</span><span class="s2">"/v1/bank_accounts/BA6oxYWJXxeM63vMorgtSIhI"</span><span class="p">)</span>
</pre></div>
</div>


</div>
</li>
<li>
<p class="first">Credit the customer:</p>
<div class="request">
<p>Request</p>


<div class="highlight-ruby">
<div class="highlight"><pre><span class="n">customer</span> <span class="o">=</span> <span class="no">Balanced</span><span class="o">::</span><span class="no">Customer</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">'/v1/customers/CU5f64LhFMO8cf7N1sQSRVOo'</span><span class="p">)</span>
<span class="n">customer</span><span class="o">.</span><span class="n">credit</span><span class="p">(</span><span class="ss">:amount</span> <span class="o">=&gt;</span> <span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>


</div>
</li>
</ol>
<div class="clear mb-large">
</div>
<div class="alert alert-tab admonition note">
note</div>
<div class="alert alert-gray">
For simplicity, Balanced does NOT take its fees from any of your
operations, instead it meters your API usage and invoices you nightly.
Read <a class="reference internal" href="overview.html#invoicing-fees"><em>more about fees</em></a>.</div>
<div class="alert alert-tab admonition note">
note</div>
<div class="alert alert-gray">
Please note that for American Express cards it is mandatory to collect
the zip-code or the transaction will fail.</div>
</section><hr>
<section id="balanced-js-card-reference"><span id="getting-started-balanced-js-cards"></span><h2>Balanced.js Card Reference<a class="headerlink" href="#balanced-js-card-reference" title="Permalink to this headline"></a>
</h2>
<dl class="function">
<dt id="balanced.card.create">
<span class="descclassname">balanced.card.</span><span class="descname">create</span><big>(</big><em>cardDataObject</em>, <em>callback</em><big>)</big><a class="headerlink" href="#balanced.card.create" title="Permalink to this definition"></a>
</dt>
<dd>
<p>Sends the data stored in the <span class="docutils literal"><code>cardDataObject</code></span> to Balanced's servers for
tokenization.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name">
<col class="field-body">
<tbody valign="top">
<tr class="field-odd field">
<th class="field-name">Arguments:</th>
<td class="field-body"><ul class="first simple">
<li>
<strong>cardDataObject.card_number</strong> -- <em>required</em>.  The credit card number</li>
<li>
<strong>cardDataObject.expiration_month</strong> -- <em>required</em>. The credit card's expiration month in the format of MM</li>
<li>
<strong>cardDataObject.expiration_year</strong> -- <em>required</em>. The credit card's expiration year in the format of YYYY</li>
<li>
<strong>cardDataObject.security_code</strong> -- <em>optional</em>. The credit card's security code</li>
<li>
<strong>cardDataObject.name</strong> -- <em>optional</em>. The credit card holder's name</li>
<li>
<strong>cardDataObject.postal_code</strong> -- <em>optional</em>. The credit card's billing postal code (zip code in the USA)</li>
</ul></td>
</tr>
<tr class="field-even field">
<th class="field-name">Returns:</th>
<td class="field-body">
<p class="first last"><span class="docutils literal"><code>null</code></span>. Invokes the <span class="docutils literal"><code>callback</code></span> function with three parameters -
<span class="docutils literal"><code>data</code></span>, <span class="docutils literal"><code>errors</code></span> and <span class="docutils literal"><code>status</code></span>. If successful, the <span class="docutils literal"><code>data</code></span>
parameter has a resource representation which can be identified by
its <span class="docutils literal"><code>uri</code></span></p>
</td>
</tr>
</tbody>
</table>
</dd>
</dl>
<dl class="function">
<dt id="balanced.card.isCardNumberValid">
<span class="descclassname">balanced.card.</span><span class="descname">isCardNumberValid</span><big>(</big><em>cardNumber</em><big>)</big><a class="headerlink" href="#balanced.card.isCardNumberValid" title="Permalink to this definition"></a>
</dt>
<dd>
<p>Validates a card number by checking if it's formatted correctly and
passes the standard <a class="reference external" href="http://en.wikipedia.org/wiki/Luhn_algorithm">Luhn check</a>. All whitespace and non-numeric data is
stripped for convenience.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name">
<col class="field-body">
<tbody valign="top">
<tr class="field-odd field">
<th class="field-name">Arguments:</th>
<td class="field-body"><ul class="first simple">
<li>
<strong>cardNumber</strong> -- the card number to Luhn validate.</li>
</ul></td>
</tr>
<tr class="field-even field">
<th class="field-name">Returns:</th>
<td class="field-body">
<p class="first last"><span class="docutils literal"><code>true</code></span> if the card number matches <a class="reference external" href="http://en.wikipedia.org/wiki/Luhn_algorithm">Luhn check</a>, <span class="docutils literal"><code>false</code></span> otherwise.</p>
</td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="highlight-javascript">
<div class="highlight"><pre><span class="nx">balanced</span><span class="p">.</span><span class="nx">card</span><span class="p">.</span><span class="nx">isCardNumberValid</span><span class="p">(</span><span class="s1">'4111111111111111'</span><span class="p">);</span>       <span class="c1">// true</span>
<span class="nx">balanced</span><span class="p">.</span><span class="nx">card</span><span class="p">.</span><span class="nx">isCardNumberValid</span><span class="p">(</span><span class="s1">'4111 1111 1111 1111'</span><span class="p">);</span>    <span class="c1">// true</span>
<span class="nx">balanced</span><span class="p">.</span><span class="nx">card</span><span class="p">.</span><span class="nx">isCardNumberValid</span><span class="p">(</span><span class="s1">'4111-1111-1111-1111'</span><span class="p">);</span>    <span class="c1">// true</span>
<span class="nx">balanced</span><span class="p">.</span><span class="nx">card</span><span class="p">.</span><span class="nx">isCardNumberValid</span><span class="p">(</span><span class="s1">'42123'</span><span class="p">);</span>                  <span class="c1">// false</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="function">
<dt id="balanced.card.cardType">
<span class="descclassname">balanced.card.</span><span class="descname">cardType</span><big>(</big><em>cardNumber</em><big>)</big><a class="headerlink" href="#balanced.card.cardType" title="Permalink to this definition"></a>
</dt>
<dd>
<p>Returns the card brand, calculated from the card number. If the card brand can
NOT be determined, it will return <span class="docutils literal"><code>null</code></span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name">
<col class="field-body">
<tbody valign="top">
<tr class="field-odd field">
<th class="field-name">Arguments:</th>
<td class="field-body"><ul class="first simple">
<li>
<strong>cardNumber</strong> -- the card number to determine the brand for.</li>
</ul></td>
</tr>
<tr class="field-even field">
<th class="field-name">Returns:</th>
<td class="field-body">
<p class="first last"><span class="docutils literal"><code>Mastercard</code></span>, <span class="docutils literal"><code>American</code> <code>Express</code></span>, <span class="docutils literal"><code>VISA</code></span>, <span class="docutils literal"><code>Discover</code> <code>Card</code></span>, or <span class="docutils literal"><code>null</code></span></p>
</td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="highlight-javascript">
<div class="highlight"><pre><span class="nx">balanced</span><span class="p">.</span><span class="nx">card</span><span class="p">.</span><span class="nx">cardType</span><span class="p">(</span><span class="s1">'5105105105105100'</span><span class="p">);</span>   <span class="c1">// Mastercard</span>
<span class="nx">balanced</span><span class="p">.</span><span class="nx">card</span><span class="p">.</span><span class="nx">cardType</span><span class="p">(</span><span class="s1">'4111111111111111'</span><span class="p">);</span>   <span class="c1">// VISA</span>
<span class="nx">balanced</span><span class="p">.</span><span class="nx">card</span><span class="p">.</span><span class="nx">cardType</span><span class="p">(</span><span class="s1">'341111111111111'</span><span class="p">);</span>    <span class="c1">// American Express</span>
<span class="nx">balanced</span><span class="p">.</span><span class="nx">card</span><span class="p">.</span><span class="nx">cardType</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>                     <span class="c1">// null</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="function">
<dt id="balanced.card.isSecurityCodeValid">
<span class="descclassname">balanced.card.</span><span class="descname">isSecurityCodeValid</span><big>(</big><em>cardNumber</em>, <em>securityCode</em><big>)</big><a class="headerlink" href="#balanced.card.isSecurityCodeValid" title="Permalink to this definition"></a>
</dt>
<dd>
<p>Checks whether or not the supplied number could be a valid card security code
for the supplied card number.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name">
<col class="field-body">
<tbody valign="top">
<tr class="field-odd field">
<th class="field-name">Arguments:</th>
<td class="field-body"><ul class="first simple">
<li>
<strong>cardNumber</strong> -- the card number to determine the validate the security code for.</li>
<li>
<strong>securityCode</strong> -- the security number to validate</li>
</ul></td>
</tr>
<tr class="field-even field">
<th class="field-name">Returns:</th>
<td class="field-body">
<p class="first last"><span class="docutils literal"><code>true</code></span> if the csc is valid for the card number provided, <span class="docutils literal"><code>false</code></span> otherwise.</p>
</td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="highlight-javascript">
<div class="highlight"><pre><span class="nx">balanced</span><span class="p">.</span><span class="nx">card</span><span class="p">.</span><span class="nx">isSecurityCodeValid</span><span class="p">(</span><span class="s1">'4111111111111111'</span><span class="p">,</span> <span class="mi">999</span><span class="p">)</span>   <span class="c1">// true</span>
<span class="nx">balanced</span><span class="p">.</span><span class="nx">card</span><span class="p">.</span><span class="nx">isSecurityCodeValid</span><span class="p">(</span><span class="s1">'4111111111111111'</span><span class="p">,</span> <span class="mi">9999</span><span class="p">)</span>  <span class="c1">// false</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="function">
<dt id="balanced.card.isExpiryValid">
<span class="descclassname">balanced.card.</span><span class="descname">isExpiryValid</span><big>(</big><em>expirationMonth</em>, <em>expirationYear</em><big>)</big><a class="headerlink" href="#balanced.card.isExpiryValid" title="Permalink to this definition"></a>
</dt>
<dd>
<p>Returns true if <span class="docutils literal"><code>expirationMonth</code></span> and <span class="docutils literal"><code>expirationYear</code></span> correspond to
a date in the future.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name">
<col class="field-body">
<tbody valign="top">
<tr class="field-odd field">
<th class="field-name">Arguments:</th>
<td class="field-body"><ul class="first simple">
<li>
<strong>expirationMonth</strong> -- the expiration month to validate</li>
<li>
<strong>expirationYear</strong> -- the expiration year to validate</li>
</ul></td>
</tr>
<tr class="field-even field">
<th class="field-name">Returns:</th>
<td class="field-body">
<p class="first last"><span class="docutils literal"><code>true</code></span> if the expiration date is in the future, <span class="docutils literal"><code>false</code></span> otherwise.</p>
</td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="highlight-javascript">
<div class="highlight"><pre><span class="nx">balanced</span><span class="p">.</span><span class="nx">card</span><span class="p">.</span><span class="nx">isExpiryValid</span><span class="p">(</span><span class="s1">'01'</span><span class="p">,</span> <span class="s1">'2020'</span><span class="p">);</span>    <span class="c1">// true</span>
<span class="nx">balanced</span><span class="p">.</span><span class="nx">card</span><span class="p">.</span><span class="nx">isExpiryValid</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2010</span><span class="p">);</span>         <span class="c1">// false</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="function">
<dt id="balanced.card.validate">
<span class="descclassname">balanced.card.</span><span class="descname">validate</span><big>(</big><em>cardDataObject</em><big>)</big><a class="headerlink" href="#balanced.card.validate" title="Permalink to this definition"></a>
</dt>
<dd>
<p>Performs a suite of checks on the submitted credit card data and returns
a dictionary of errors. Will return an empty dictionary if there are no
errors.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name">
<col class="field-body">
<tbody valign="top">
<tr class="field-odd field">
<th class="field-name">Arguments:</th>
<td class="field-body"><ul class="first simple">
<li>
<strong>cardDataObject.card_number</strong> -- the card number to validate</li>
<li>
<strong>cardDataObject.security_code</strong> -- the security code to validate</li>
<li>
<strong>cardDataObject.expiration_month</strong> -- the expiration month to validate</li>
<li>
<strong>cardDataObject.expiration_year</strong> -- the expiration year to validate</li>
</ul></td>
</tr>
<tr class="field-even field">
<th class="field-name">Returns:</th>
<td class="field-body">
<p class="first last"><span class="docutils literal"><code>{}</code></span> if all fields are valid, else a dictionary of errors otherwise.</p>
</td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="highlight-javascript">
<div class="highlight"><pre><span class="nx">balanced</span><span class="p">.</span><span class="nx">card</span><span class="p">.</span><span class="nx">validate</span><span class="p">({</span>
   <span class="nx">card_number</span><span class="o">:</span><span class="s1">'4111111111111111'</span><span class="p">,</span>
   <span class="nx">expiration_month</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span>
   <span class="nx">expiration_year</span><span class="o">:</span><span class="mi">2000</span><span class="p">,</span>
   <span class="nx">security_code</span><span class="o">:</span><span class="mi">123</span>
<span class="p">});</span>
</pre></div>
</div>
<p>Will return:</p>
<div class="highlight-javascript">
<div class="highlight"><pre><span class="p">{</span><span class="nx">expiration</span><span class="o">:</span> <span class="s1">'"1-2000" is not a valid credit card expiration date'</span><span class="p">}</span>
</pre></div>
</div>
</dd>
</dl></section><hr>
<section id="balanced-js-bankaccount-reference"><span id="getting-started-balanced-js-bank-accounts"></span><h2>Balanced.js BankAccount Reference<a class="headerlink" href="#balanced-js-bankaccount-reference" title="Permalink to this headline"></a>
</h2>
<dl class="function">
<dt id="balanced.bankAccount.validateRoutingNumber">
<span class="descclassname">balanced.bankAccount.</span><span class="descname">validateRoutingNumber</span><big>(</big><em>routingNumber</em><big>)</big><a class="headerlink" href="#balanced.bankAccount.validateRoutingNumber" title="Permalink to this definition"></a>
</dt>
<dd>
<p>Validates a USA based bank routing number using the <a class="reference external" href="http://en.wikipedia.org/wiki/Routing_transit_number#MICR_Routing_number_format">MICR Routing Number Format</a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name">
<col class="field-body">
<tbody valign="top">
<tr class="field-odd field">
<th class="field-name">Arguments:</th>
<td class="field-body"><ul class="first simple">
<li>
<strong>routingNumber</strong> -- a 9 digit routing number, it may have a leading zero!</li>
</ul></td>
</tr>
<tr class="field-even field">
<th class="field-name">Returns:</th>
<td class="field-body">
<p class="first last"><span class="docutils literal"><code>true</code></span> if the routing number check digit matches, <span class="docutils literal"><code>false</code></span> otherwise.</p>
</td>
</tr>
</tbody>
</table>
<div class="alert alert-tab admonition warning">
warning</div>
<div class="alert alert-gray">
The success of this method does not guarantee that the
routing number is valid, only that it falls within a valid range.</div>
<p>Example:</p>
<div class="highlight-javascript">
<div class="highlight"><pre><span class="nx">balanced</span><span class="p">.</span><span class="nx">bankAccount</span><span class="p">.</span><span class="nx">validateRoutingNumber</span><span class="p">(</span><span class="s1">'321174851'</span><span class="p">)</span> <span class="c1">// passes</span>
<span class="nx">balanced</span><span class="p">.</span><span class="nx">bankAccount</span><span class="p">.</span><span class="nx">validateRoutingNumber</span><span class="p">(</span><span class="s1">'021000021'</span><span class="p">)</span> <span class="c1">// passes</span>
<span class="nx">balanced</span><span class="p">.</span><span class="nx">bankAccount</span><span class="p">.</span><span class="nx">validateRoutingNumber</span><span class="p">(</span><span class="s1">'123457890'</span><span class="p">)</span> <span class="c1">// fails</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="function">
<dt id="balanced.bankAccount.validate">
<span class="descclassname">balanced.bankAccount.</span><span class="descname">validate</span><big>(</big><em>bankAccountDataObject</em><big>)</big><a class="headerlink" href="#balanced.bankAccount.validate" title="Permalink to this definition"></a>
</dt>
<dd>
<p>Performs a suite of checks on the submitted bank account data and
returns a dictionary of errors. Will return an empty dictionary if there
are no errors.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name">
<col class="field-body">
<tbody valign="top">
<tr class="field-odd field">
<th class="field-name">Arguments:</th>
<td class="field-body"><ul class="first simple">
<li>
<strong>bankAccountDataObject.routing_number</strong> -- The bank routing number to validate</li>
<li>
<strong>bankAccountDataObject.account_number</strong> -- the account number to perform a sanity check on</li>
<li>
<strong>bankAccountDataObject.name</strong> -- the name on the bank account to perform a sanity check on</li>
</ul></td>
</tr>
<tr class="field-even field">
<th class="field-name">Returns:</th>
<td class="field-body">
<p class="first last"><span class="docutils literal"><code>{}</code></span> if all fields are valid, else a dictionary of errors otherwise.</p>
</td>
</tr>
</tbody>
</table>
<div class="alert alert-tab admonition warning">
warning</div>
<div class="alert alert-gray">
Account numbers can not be validated in real time. More on
<a class="reference internal" href="overview.html#best-practices-reducing-payout-delays"><em>reducing payout delays</em></a>.</div>
<p>Example:</p>
<div class="highlight-javascript">
<div class="highlight"><pre><span class="nx">balanced</span><span class="p">.</span><span class="nx">bankAccount</span><span class="p">.</span><span class="nx">validate</span><span class="p">({</span>
   <span class="nx">routing_number</span><span class="o">:</span><span class="s1">'321174851'</span><span class="p">,</span>
   <span class="nx">account_number</span><span class="o">:</span><span class="s1">'09877765432111111'</span><span class="p">,</span>
   <span class="nx">name</span><span class="o">:</span><span class="s1">'Tommy Q. CopyPasta'</span>
<span class="p">})</span>
</pre></div>
</div>
</dd>
</dl></section></section><hr>
<span id="document-best_practices"></span><section id="best-practices"><span id="id1"></span><h1>Best Practices<a class="headerlink" href="#best-practices" title="Permalink to this headline"></a>
</h1>
<hr>
<section id="going-live-checklist"><span id="best-practices-going-live-checklist"></span><h2>Going Live Checklist<a class="headerlink" href="#going-live-checklist" title="Permalink to this headline"></a>
</h2>
<ul class="simple">
<li>Ensure servers use SSL</li>
<li>Use <a class="reference internal" href="overview.html#use-balanced-js"><em>balanced.js</em></a>
</li>
<li>Verify the use of <a class="reference external" href="#best-practices">best practices</a>
</li>
<li>Review the <a class="reference external" href="https://www.balancedpayments.com/terms/">Terms &amp; Conditions</a>,
<a class="reference external" href="https://www.balancedpayments.com/terms/marketplaceagreement">Marketplace Agreement</a>,
and <a class="reference external" href="https://www.balancedpayments.com/privacy">Privacy Policy</a>.</li>
<li>Include client terms snippet (#2) from <a class="reference external" href="https://www.balancedpayments.com/terms/marketplaceagreement">marketplace agreement</a> in client terms and conditions</li>
<li>Include the <a class="reference external" href="http://www.quora.com/Balanced/I-am-in-the-process-of-adding-Balanced-to-my-site-and-want-to-use-the-Balanced-logo-Is-that-allowed">credit card brand logos</a> on the checkout page</li>
<li>Include a <a class="reference external" href="https://github.com/balanced/balanced-dashboard/issues/24#issuecomment-17952768">"Secured by Balanced" badge</a> on the site footer or checkout page</li>
<li><a class="reference external" href="#obtain-a-production-marketplace">Register for a production marketplace</a></li>
<li>Change API key to production API key</li>
<li>Change application marketplace URI to production marketplace URI</li>
</ul></section><hr>
<section id="use-balanced-js"><span id="id2"></span><h2>Use balanced.js<a class="headerlink" href="#use-balanced-js" title="Permalink to this headline"></a>
</h2>
<p>Use balanced.js to tokenize cards and bank accounts. balanced.js keeps your systems PCI compliant
by sending sensitive information over SSL directly to the Balanced servers.</p>
<div class="alert alert-tab admonition note">
note</div>
<div class="alert alert-gray">
This does not remove the need for you to use SSL on your servers as all financial transactions
should occur over SSL.</div>
</section><hr>
<section id="soft-descriptors"><span id="best-practices-soft-descriptor"></span><h2>Soft Descriptors<a class="headerlink" href="#soft-descriptors" title="Permalink to this headline"></a>
</h2>
<p>Set a soft descriptor for your transactions. Soft descriptors appear on customer's card and bank
statements for every transaction performed.</p>
<p>Soft descriptors have the following limits:</p>
<ul class="simple">
<li>Debits (Cards): 18 characters.</li>
<li>Debits (ACH): 14 characters</li>
<li>Credits: 14 characters.</li>
</ul>
<p>Balanced recommends the following format for soft descriptors from left to right, space permitting:</p>
<p>[short marketplace descriptor] [order number] and/or [seller company name]</p>
<p>For example, "BHub 187451 TastyB"</p>
<p>This format provides two key pieces of information to customers. They identify the marketplace
from which the bank transaction originated, and they identify the transaction itself. <strong>Who</strong>
the charge came from rather than <strong>what</strong> the charge was for is more important in soft descriptors.</p>
<p>This facilitates bank statement reconciliation and simplifies customer support by allowing customers,
merchants, and marketplaces to search by the same information. It's also recommended marketplaces
email receipts containing the order numbers and use it as the place to list for what the transaction
was performed.</p>
<p>Setting the soft descriptor is achieved by setting <span class="docutils literal"><code>appears_on_statement_as</code></span> when performing
a debit or a credit.</p>
</section><hr>
<section id="reducing-declined-transactions"><span id="best-practices-payouts"></span><h2>Reducing Declined Transactions<a class="headerlink" href="#reducing-declined-transactions" title="Permalink to this headline"></a>
</h2>
<p>Fraud and Card declinations can be reduced if the following information is supplied when tokenizing a card:</p>
<ul class="simple">
<li>
<span class="docutils literal"><code>name</code></span> (Name on card)</li>
<li>
<span class="docutils literal"><code>security_code</code></span> (CVV)</li>
<li>
<span class="docutils literal"><code>postal_code</code></span> (Postal code)</li>
</ul>
<div class="line-block">
<div class="line"><br></div>
</div>
<div class="alert alert-tab-red admonition note">
note</div>
<div class="alert alert-gray">
Balanced highly recommends collecting <span class="docutils literal"><code>security_code</code></span> and <span class="docutils literal"><code>postal_code</code></span> for
transactions on American Express cards. Collecting this information dramatically
increases acceptance rates for AMEX.</div>
</section><hr>
<section id="catching-fraud-early"><h2>Catching Fraud Early<a class="headerlink" href="#catching-fraud-early" title="Permalink to this headline"></a>
</h2>
<p>It's very important to take a proactive stance against fraud. Below are some
tips to help guard against it. We recommend marketplaces take advantage of
the following:</p>
<ul class="simple">
<li>Utilize customer verification. We highly recommended that you do not issue payouts to
unverified customers. Refer to <a class="reference internal" href="overview.html#resources-test-identity-verification"><em>Test identity verification</em></a>
</li>
<li>Utilize AVS. Refer to <a class="reference internal" href="overview.html#resources-address-verification-service"><em>Address Verification Service</em></a>
</li>
<li>Utilize CSC. Refer to <a class="reference internal" href="overview.html#resources-card-security-code"><em>Card Security Code</em></a>
</li>
<li>Respond in a timely fashion to Balanced inquiries about chargebacks or suspicious transactions</li>
<li>Report fraud to <a class="reference external" href="mailto:support%40balancedpayments.com">support<span>@</span>balancedpayments<span>.</span>com</a>.</li>
</ul></section><hr>
<section id="reducing-payout-delays"><span id="best-practices-reducing-payout-delays"></span><h2>Reducing Payout Delays<a class="headerlink" href="#reducing-payout-delays" title="Permalink to this headline"></a>
</h2>
<p>Automated Clearing House transactions are asynchronous, requiring upfront effort
in educating your consumers and setting the appropriate expectations to deliver
a great product.</p>
<p>Balanced validates bank routing numbers in real-time using the
<a class="reference external" href="https://www.fededirectory.frb.org">FedACH directory</a>, but since bank account numbers are not standardized, incorrect
bank account numbers are not caught until the payout fails.
Unfortunately, due to the nature of the ACH network, failure notifications can be delayed
for up to (4) four business days. This means that an account number typo can, on average,
cause payment delays by up to (3) three to (5) five business days.</p>
<p>Since you or your users may rely on these funds as operating capital, this delay can be
extremely inconvenient and frustrating to you and your users.</p>
<p>Our recommendation, for mitigating these user experience issues, is to properly
invest time in building a robust and reliable form to collect the merchant
bank account information properly.</p>
<p>Here are some tips:</p>
<ol class="arabic">
<li>
<p class="first">Display a check image to illustrate which number is the routing number vs.
account number.</p>
<p>We've conveniently provided one - however, you may choose to design your
own:</p>
<div class="figure">
<img alt="https://s3.amazonaws.com/justice.web/docs/check_image.png" src="https://s3.amazonaws.com/justice.web/docs/check_image.png">
</div>
</li>
<li>
<p class="first">US routing numbers are 9 digits and are usually located in the lower left
corner of most checks. Common aliases to <strong>routing number</strong>:</p>
<ul class="simple">
<li>RTN (Routing Transit Number)</li>
<li>ABA</li>
<li><a class="reference external" href="http://en.wikipedia.org/wiki/Bank_code">Bank code</a></li>
</ul>
</li>
<li>
<p class="first">Routing numbers are used to set up direct deposit transfers. You can use this
as an aid to your customers who are inquiring whether or not they have the
right routing number.</p>
</li>
<li>
<p class="first">If you're double checking routing numbers for customers, most banks assign routing numbers
according to the state or region of the state that the bank account was opened in.</p>
</li>
<li>
<p class="first">Encourage customers to check their bank websites for the routing number used specifically
for ACH or electronic deposits. Some large banks, particularly Bank Of America, may have
different routing numbers for checks and direct deposits.</p>
</li>
<li>
<p class="first">Balanced has provided very useful routing number validators in our
<a class="reference internal" href="overview.html#getting-started-balanced-js-bank-accounts"><em>balanced.js</em></a> library.
Use these helper functions to build a robust form.</p>
</li>
<li>
<p class="first">Set your customer's expectation that payments might be delayed by up to
(3) three to (5) five business days if incorrect information is provided.</p>
</li>
<li>
<p class="first">Highlight to your customers that <em>wire transfer numbers</em> are <strong>NOT</strong> the same
as the routing number, and they are <strong>NOT</strong> the same as the bank account
number. Be sure to clarify this when asking your users for their information.</p>
</li>
</ol>
<p>Our statistics show that most of the time, with the help of a properly designed and robust
form, your users will provide the correct bank routing and account numbers.</p>
<p>With correct bank information their payout will usually appear the next business day, as
expected. Once a successful payout has been made, future credits to that bank account
will continue to take one business day when issued before the
<a class="reference internal" href="overview.html#payouts-cutoff"><em>next-day cut-offs</em></a>.</p>
<p>If a payout does fail for any reason, we&acirc;&#128;&#153;ll notify you via email, dashboard, and webhook.
If a customer complains about a payout failure and you do not see any notification with in
the expected time window, please reach out to <a class="reference external" href="mailto:support%40balancedpayments.com">support<span>@</span>balancedpayments<span>.</span>com</a> and we'll track
down the payout as soon as possible.</p>
</section><hr>
<section id="use-meta"><h2>Use Meta<a class="headerlink" href="#use-meta" title="Permalink to this headline"></a>
</h2>
<p>The <span class="docutils literal"><code>meta</code></span> field exists on all resources in the Balanced API. It may be used
as a dictionary of arbitrary key/value pairs, where each key and value is a
string of length 255 characters or less. Illustratively, this may be used to annotate
accounts in our system with the account name on your system or annotate
transactions with order numbers. The format is generally up to you, but
Balanced reserves some keys in the <span class="docutils literal"><code>meta</code></span> field. These are fields that may be
passed in by you in order to help fight fraud and respond to chargebacks.</p>
<section id="shipping-address"><h3>Shipping Address<a class="headerlink" href="#shipping-address" title="Permalink to this headline"></a>
</h3>
<p>Marketplaces may supply shipping fulfillment information by prefixing keys
specifying address data with the <span class="docutils literal"><code>shipping.</code></span> prefix. The specific
fields you may provide are:</p>
<ul class="simple">
<li>shipping.address.street_address</li>
<li>shipping.address.city</li>
<li>shipping.address.region</li>
<li>shipping.address.country_code (<a class="reference external" href="http://en.wikipedia.org/wiki/ISO_3166-1_alpha-3">ISO 3166-1 alpha-3</a>)</li>
<li>shipping.carrier</li>
<li>shipping.tracking_number</li>
</ul>
<p>Let's say you want to pass on shipping address, along with shipping
carrier (USPS, UPS, FedEx, etc.) and tracking number on a debit. This is
what the <span class="docutils literal"><code>meta</code></span> field would look like when represented as a JSON
dictionary:</p>
<div class="highlight-javascript">
<div class="highlight"><pre><span class="nx">meta</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'shipping.address.street_address'</span><span class="o">:</span> <span class="s1">'801 High St'</span><span class="p">,</span>
    <span class="s1">'shipping.address.city'</span><span class="o">:</span> <span class="s1">'Palo Alto'</span><span class="p">,</span>
    <span class="s1">'shipping.address.region'</span><span class="o">:</span> <span class="s1">'CA'</span><span class="p">,</span>
    <span class="s1">'shipping.address.postal_code'</span><span class="o">:</span> <span class="s1">'94301'</span><span class="p">,</span>
    <span class="s1">'shipping.address.country_code'</span><span class="o">:</span> <span class="s1">'USA'</span><span class="p">,</span>
    <span class="s1">'shipping.carrier'</span><span class="o">:</span> <span class="s1">'FEDEX'</span><span class="p">,</span>
    <span class="s1">'shipping.tracking_number'</span><span class="o">:</span> <span class="s1">'1234567890'</span>
<span class="p">}</span>
</pre></div>
</div>
</section><section id="listing"><h3>Listing<a class="headerlink" href="#listing" title="Permalink to this headline"></a>
</h3>
<p>Balanced <strong>strongly</strong> recommends marketplaces supply listing information for each
transaction using meta. This can be done by specifying the listing URL in the
<span class="docutils literal"><code>listing</code></span> meta key.</p>
<div class="highlight-javascript">
<div class="highlight"><pre><span class="nx">meta</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'listing'</span><span class="o">:</span> <span class="s1">'https://rentmybike-rails.herokuapp.com/listings/3'</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</section></section><hr>
<section id="implementation-patterns"><span id="best-practices-implementation-patterns"></span><h2>Implementation Patterns<a class="headerlink" href="#implementation-patterns" title="Permalink to this headline"></a>
</h2>
<section id="recurring-billing"><h3>Recurring billing<a class="headerlink" href="#recurring-billing" title="Permalink to this headline"></a>
</h3>
<p>While the Balanced API inherently supports the ability to perform recurring
billing, the logic for recurring billing must be implemented into applications
that consume the API. Applications can make use of cron or other scheduling
utilities to process recurring billing or take advantage of the Python-based
Balanced open-source application, <a class="reference external" href="https://github.com/balanced/billy">Billy</a>.</p>
</section><section id="charging-in-the-future"><h3>Charging in the future<a class="headerlink" href="#charging-in-the-future" title="Permalink to this headline"></a>
</h3>
<p>A typical first-thought solution to charging in the future is to use holds.
Marketplaces centered around crowdfunding often want to use holds to ensure
funds are available upon project completion. Since Holds only last for 7 days,
a common misuse is to refresh the hold repeatedly until the campaign succeeds.
This is not recommended since it makes for a poor user experience. Instead,
tokenize the card and create a hold 7 days before a successful campaign ends.
If the campaign is not expected to succeed, no holds should be placed. If you
expect to capture buyer funds regardless of whether a campaign succeeds,
you should simply debit the card.</p>
<p>Holds are suited for environments where the exact cost of a transaction
cannot be predicted; for example, tips and temporary deposits.</p>
</section></section><hr>
<section id="store-uris"><span id="best-practices-uri-vs-id"></span><h2>Store URIs<a class="headerlink" href="#store-uris" title="Permalink to this headline"></a>
</h2>
<p>Do you store the <span class="docutils literal"><code>uri</code></span> or the <span class="docutils literal"><code>id</code></span> in your database? <strong>Always, always
store the URI</strong>.</p>
<p>The URI stands for <strong>U</strong>niversal <strong>R</strong>esource <strong>I</strong>dentifier and it's
exactly what it is. An identifier.</p>
<p>Do not attempt to be clever and try to save a few bytes by storing the ID
and constructing the URI later. This will almost always lead to disaster.</p>
<p>A URI is opaque and Balanced reserves the right to use HTTP semantics
later to change them. This means that while Balanced will not change the
URI, Balanced may change components of the URI; including the ID.
You should <strong>NEVER</strong> store the ID.</p>
<p>Balanced's internal statistics show that client libraries that construct the <span class="docutils literal"><code>uri</code></span>
receive roughly <strong>2 orders of magnitude</strong> more <span class="docutils literal"><code>404</code></span> status codes from Balanced
than clients which use the <span class="docutils literal"><code>uri</code></span> returned in responses from the Balanced API.</p>
<div class="alert alert-tab admonition note">
note</div>
<div class="alert alert-gray">
URIs will not be longer than 255 characters.</div>
</section><hr>
<section id="getting-help"><span id="best-practices-getting-help"></span><h2>Getting Help<a class="headerlink" href="#getting-help" title="Permalink to this headline"></a>
</h2>
<p>When encountering a problem, one of the best tools available to you is
the Logs area in the Dashboard. These logs give valuable insight into
what request information was received and the resulting API response. It also
gives information about operation status codes and transaction failure
messages along with the timing and affected parties and endpoints.</p>
<p>If additional help is required, hop into #balanced on IRC to get help
directly from developers.</p>
<p>Be sure to have the following handy to facilitate quick resolutions to issues:</p>
<ul class="simple">
<li>A description of the problem</li>
<li>The Dashboard link to the transaction(s) related to the issue (if one exists. if there
is more than one please provide enough transactions and their corresponding links so
that we have a sample set that we can begin investigating)</li>
<li>Transaction OHM (this is the identifier for the corresponding log message. It's returned on errors)</li>
<li>Marketplace name</li>
<li>Timeframe of issue</li>
<li>Affected customer(s)</li>
<li>Amount and type of transaction</li>
<li>Last 4 digits and type of the affected card (if applicable)</li>
</ul></section></section><hr>
<span id="document-processing"></span><section id="processing"><span id="id1"></span><h1>Processing<a class="headerlink" href="#processing" title="Permalink to this headline"></a>
</h1>
<p>Balanced provides a complete processing solution for accepting credit
card payments in a simple, secure manner, relieving you from the hassles
of PCI compliance.</p>
<hr>
<section id="debits"><h2>Debits<a class="headerlink" href="#debits" title="Permalink to this headline"></a>
</h2>
<div class="span6">
<div class="header3">
Tutorials</div>
<div class="box box-block box-blue">
<span class="icon icon-page"></span>
<a class="reference internal" href="overview.html#getting-started-collecting-card-info"><em>Collect credit card info</em></a>
</div>
<div class="box box-block box-blue">
<span class="icon icon-page"></span>
<a class="reference internal" href="overview.html#getting-started-charging-cards"><em>Charge a credit card</em></a>
</div>
</div>
<div class="span6">
<div class="header3">
Form Building</div>
<div class="box box-block box-turquoise">
<span class="icon icon-page"></span>
<a class="reference external" href="http://jsfiddle.net/balanced/ZwhrA/">Sample credit card form</a>
</div>
<div class="box box-block box-turquoise">
<span class="icon icon-page"></span>
<a class="reference external" href="http://jsfiddle.net/balanced/ZwhrA/">Sample bank account form</a>
</div>
</div>
<div class="span6">
<div class="header3">
Testing</div>
<div class="box box-block box-purple">
<span class="icon icon-page"></span>
<a class="reference internal" href="overview.html#resources-test-credit-cards"><em>Test credit card numbers</em></a>
</div>
</div>
<div class="clear">
</div>
</section><hr>
<section id="refunds"><h2>Refunds<a class="headerlink" href="#refunds" title="Permalink to this headline"></a>
</h2>
<p>You can refund a debit up to its original amount, so that means you can partially
refund a debit as well.</p>
<p>In order for a refund to go through successfully, you <em>must</em> have enough money
in <a class="reference internal" href="overview.html#mp-escrow"><em>implicit escrow</em></a> to cover your refund.</p>
<div class="alert alert-tab admonition note">
note</div>
<div class="alert alert-gray">
For credit cards it typically takes one business day for refunds to
be reflected on a card statement, but it's possible for the issuing bank to
take as many as five business days to process a refund.</div>
<p>Here are some scenarios:</p>
<section id="full-refund"><h3>Full Refund<a class="headerlink" href="#full-refund" title="Permalink to this headline"></a>
</h3>
<p>Let's say you've debited an account for $20.00</p>
<ul class="simple">
<li>Your marketplace's <a class="reference external" href="https://dashboard.balancedpayments.com/#/marketplaces/">dashboard</a> escrow balance says $20.00</li>
<li>You issue a refund for $20.00</li>
<li>Your marketplace's <a class="reference external" href="https://dashboard.balancedpayments.com/#/marketplaces/">dashboard</a> escrow balance says $0.00</li>
</ul></section><section id="partial-refund"><h3>Partial Refund<a class="headerlink" href="#partial-refund" title="Permalink to this headline"></a>
</h3>
<p>You can also perform multiple partial refunds up to the original amount.</p>
<p>Let's say you've debited an account for $20.00</p>
<ul class="simple">
<li>Your marketplace's <a class="reference external" href="https://dashboard.balancedpayments.com/#/marketplaces/">dashboard</a> escrow balance says $20.00</li>
<li>You issue a refund for $10.00</li>
<li>Your marketplace's <a class="reference external" href="https://dashboard.balancedpayments.com/#/marketplaces/">dashboard</a> escrow balance says $10.00</li>
<li>You issue another refund for $5.00</li>
<li>Your marketplace's <a class="reference external" href="https://dashboard.balancedpayments.com/#/marketplaces/">dashboard</a> escrow balance says $5.00</li>
</ul></section><section id="not-enough-funds-to-refund"><h3>Not Enough Funds to Refund<a class="headerlink" href="#not-enough-funds-to-refund" title="Permalink to this headline"></a>
</h3>
<p>Let's say you've debited an account for $20.00</p>
<ul class="simple">
<li>Your marketplace's <a class="reference external" href="https://dashboard.balancedpayments.com/#/marketplaces/">dashboard</a> escrow balance says $20.00</li>
<li>You issue a refund for $30.00</li>
<li>The API will return a <strong>400</strong> status code, similar to:</li>
</ul>
</section></section><hr>
<section id="holds"><span id="processing-holds"></span><h2>Holds<a class="headerlink" href="#holds" title="Permalink to this headline"></a>
</h2>
<p>Balanced supports the concepts of <em class="xref std std-term">holds</em>. Holds are a type of
authorization that reserves (i.e. holds) a dollar amount on the customer's
credit card for the merchant to process later, usually within 7 days. If the
transaction is not processed (known as post-authorization) by the end of the
hold period, the amount is added back to the available credit on the
cardholder's credit card. <strong>The customer is not billed.</strong></p>
<p>Holds are common in the industries where the amount of the goods or services
are "reserved" on the cardholder's credit card.</p>
<p>If you issue a debit on an account, Balanced uses holds behinds the scenes
but captures the funds immediately -- you will
<strong>always see an expanded hold resource returned on a debit representation</strong>.</p>
<div class="alert alert-tab admonition warning">
warning</div>
<div class="alert alert-gray">
<p>For all intents and purposes, Balanced does not recommend holds and considers
their usage as a very advanced feature as they cause much confusion and are
cumbersome to manage.</p>
<p>If your project requires holds and you need help, please reach out
to us using our <a class="reference internal" href="overview.html#overview-support"><em>support channels</em></a>.</p>
</div>
<section id="creating-a-hold"><h3>Creating a hold<a class="headerlink" href="#creating-a-hold" title="Permalink to this headline"></a>
</h3>
<p>A hold is created in a way similar to creating a debit. Creating a hold will
return a URI which can be used to perform a capture later, up to the full
amount of the hold.</p>
<div class="request">
<p>Request</p>


<div class="highlight-ruby">
<div class="highlight"><pre><span class="nb">require</span> <span class="s1">'balanced'</span>
<span class="no">Balanced</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s1">'ak-test-2KZfoLyijij3Y6OyhDAvFRF9tXzelBLpD'</span><span class="p">)</span>

<span class="n">hold</span> <span class="o">=</span> <span class="no">Balanced</span><span class="o">::</span><span class="no">Hold</span><span class="o">.</span><span class="n">new</span><span class="p">(</span>
  <span class="ss">:amount</span> <span class="o">=&gt;</span> <span class="mi">5000</span><span class="p">,</span>
  <span class="ss">:description</span> <span class="o">=&gt;</span> <span class="s1">'Some descriptive text for the debit in the dashboard'</span><span class="p">,</span>
  <span class="ss">:source_uri</span> <span class="o">=&gt;</span> <span class="s1">'/v1/marketplaces/TEST-MP4K6K0PWGyPtXL4LZ42sQSb/cards/CC7iFRCb5AvLuZ9qzIF0VMmA'</span>
<span class="p">)</span>
<span class="n">hold</span><span class="o">.</span><span class="n">save</span>
</pre></div>
</div>


</div>
</section><section id="capturing-a-hold"><h3>Capturing a hold<a class="headerlink" href="#capturing-a-hold" title="Permalink to this headline"></a>
</h3>
<p>Here's an example on how to capture a hold:</p>
<div class="request">
<p>Request</p>


<div class="highlight-ruby">
<div class="highlight"><pre><span class="nb">require</span> <span class="s1">'balanced'</span>
<span class="no">Balanced</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s1">'ak-test-2KZfoLyijij3Y6OyhDAvFRF9tXzelBLpD'</span><span class="p">)</span>

<span class="n">hold</span> <span class="o">=</span> <span class="no">Balanced</span><span class="o">::</span><span class="no">Hold</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">'/v1/marketplaces/TEST-MP4K6K0PWGyPtXL4LZ42sQSb/holds/HL74dRg2HWc5vQwX0kQ9XQfM'</span><span class="p">)</span>
<span class="n">debit</span> <span class="o">=</span> <span class="n">hold</span><span class="o">.</span><span class="n">capture</span><span class="p">(</span>
  <span class="ss">:appears_on_statement_as</span> <span class="o">=&gt;</span> <span class="s1">'ShowsUpOnStmt'</span><span class="p">,</span>
  <span class="ss">:description</span> <span class="o">=&gt;</span> <span class="s1">'Some descriptive text for the debit in the dashboard'</span>
<span class="p">)</span>
</pre></div>
</div>


</div>
</section></section><hr>
<section id="transaction-limits"><span id="processing-transaction-limits"></span><h2>Transaction Limits<a class="headerlink" href="#transaction-limits" title="Permalink to this headline"></a>
</h2>
<p>The minimum transaction amount is $0.50.</p>
<p>The maximum transaction amounts are as follows:</p>
<p>Credit cards - $15,000 per transaction.</p>
<p>Bank account debits - $15,000 per transaction.</p>
<p>Bank account credits - $15,000 per transaction.</p>
<div class="alert alert-tab admonition note">
note</div>
<div class="alert alert-gray">
<p>Please contact <a class="reference external" href="mailto:support%40balancedpayments.com">support<span>@</span>balancedpayments<span>.</span>com</a>
if you are planning to process larger amounts.</p>
<p>These limits do not apply to the marketplace owner bank account.</p>
</div>
</section></section><hr>
<span id="document-payouts"></span><section id="balanced-payouts"><span id="payouts"></span><h1>Balanced Payouts<a class="headerlink" href="#balanced-payouts" title="Permalink to this headline"></a>
</h1>
<p>Balanced Payouts is a stand-alone service for sending money to your seller's
bank account via the ACH network. You can use Balanced Payouts with your
existing processing solution without needing to switch or you may want to
integrate <a class="reference internal" href="overview.html#processing"><em>Balanced Processing</em></a>.</p>
<hr>
<section id="credits"><h2>Credits<a class="headerlink" href="#credits" title="Permalink to this headline"></a>
</h2>
<div class="span6">
<div class="header3">
Tutorials</div>
<div class="box box-block box-blue">
<span class="icon icon-page"></span>
<a class="reference internal" href="overview.html#getting-started-collecting-bank-info"><em>Collect bank account info</em></a>
</div>
<div class="box box-block box-blue">
<span class="icon icon-page"></span>
<a class="reference internal" href="overview.html#getting-started-credit-bank-account"><em>Credit bank account</em></a>
</div>
</div>
<div class="span6">
<div class="header3">
Form Building</div>
<div class="box box-block box-turquoise">
<span class="icon icon-page"></span>
Sample bank account form</div>
</div>
<div class="span6">
<div class="header3">
Testing</div>
<div class="box box-block box-purple">
<span class="icon icon-page"></span>
<a class="reference internal" href="overview.html#resources-test-bank-accounts"><em>Test bank account numbers</em></a>
</div>
</div>
<div class="clear">
</div>
</section><hr>
<section id="credit-s-status-field"><h2>Credit's Status Field<a class="headerlink" href="#credit-s-status-field" title="Permalink to this headline"></a>
</h2>
<p>Credits have a <span class="docutils literal"><code>status</code></span> field representing the current status of the credit
through the payout process.</p>
<div class="response">
<p>Response</p>
<div class="highlight-javascript">
<div class="highlight"><pre><span class="p">{</span>
    <span class="s2">"_type"</span><span class="o">:</span> <span class="s2">"credit"</span><span class="p">,</span> 
    <span class="s2">"_uris"</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">"events_uri"</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">"_type"</span><span class="o">:</span> <span class="s2">"page"</span><span class="p">,</span> 
            <span class="s2">"key"</span><span class="o">:</span> <span class="s2">"events"</span>
        <span class="p">},</span> 
        <span class="s2">"reversals_uri"</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">"_type"</span><span class="o">:</span> <span class="s2">"page"</span><span class="p">,</span> 
            <span class="s2">"key"</span><span class="o">:</span> <span class="s2">"reversals"</span>
        <span class="p">}</span>
    <span class="p">},</span> 
    <span class="s2">"amount"</span><span class="o">:</span> <span class="mi">10000</span><span class="p">,</span> 
    <span class="s2">"appears_on_statement_as"</span><span class="o">:</span> <span class="s2">"example.com"</span><span class="p">,</span> 
    <span class="s2">"bank_account"</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">"_type"</span><span class="o">:</span> <span class="s2">"bank_account"</span><span class="p">,</span> 
        <span class="s2">"_uris"</span><span class="o">:</span> <span class="p">{},</span> 
        <span class="s2">"account_number"</span><span class="o">:</span> <span class="s2">"xxxxxx0001"</span><span class="p">,</span> 
        <span class="s2">"bank_name"</span><span class="o">:</span> <span class="s2">"BANK OF AMERICA, N.A."</span><span class="p">,</span> 
        <span class="s2">"can_debit"</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span> 
        <span class="s2">"fingerprint"</span><span class="o">:</span> <span class="s2">"1eH719hwbYRpEILVKyboPs_pn"</span><span class="p">,</span> 
        <span class="s2">"meta"</span><span class="o">:</span> <span class="p">{},</span> 
        <span class="s2">"name"</span><span class="o">:</span> <span class="s2">"Johann Bernoulli"</span><span class="p">,</span> 
        <span class="s2">"routing_number"</span><span class="o">:</span> <span class="s2">"121000358"</span><span class="p">,</span> 
        <span class="s2">"type"</span><span class="o">:</span> <span class="s2">"checking"</span>
    <span class="p">},</span> 
    <span class="s2">"created_at"</span><span class="o">:</span> <span class="s2">"2013-11-22T01:44:17.886711Z"</span><span class="p">,</span> 
    <span class="s2">"description"</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span> 
    <span class="s2">"events_uri"</span><span class="o">:</span> <span class="s2">"/v1/credits/CR4FYwQ1iVxndM6C0vvANHYe/events"</span><span class="p">,</span> 
    <span class="s2">"id"</span><span class="o">:</span> <span class="s2">"CR4FYwQ1iVxndM6C0vvANHYe"</span><span class="p">,</span> 
    <span class="s2">"meta"</span><span class="o">:</span> <span class="p">{},</span> 
    <span class="s2">"reversals_uri"</span><span class="o">:</span> <span class="s2">"/v1/marketplaces/TEST-MP2oRTf6eEiGrBkS3ahqYdHN/credits/CR4FYwQ1iVxndM6C0vvANHYe/reversals"</span><span class="p">,</span> 
    <span class="s2">"status"</span><span class="o">:</span> <span class="s2">"pending"</span><span class="p">,</span> 
    <span class="s2">"uri"</span><span class="o">:</span> <span class="s2">"/v1/credits/CR4FYwQ1iVxndM6C0vvANHYe"</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<p>There are three possible values for the <span class="docutils literal"><code>status</code></span> field on a credit:</p>
<dl class="docutils">
<dt><span class="docutils literal"><code>pending</code></span></dt>
<dd>As soon as the credit is created through the API, the status shows
as <span class="docutils literal"><code>pending</code></span>. This indicates that Balanced received the information for the
credit and will begin processing. The ACH network itself processes transactions
in a batch format. Batch submissions are processed at 3pm PST on business days.
If the credit is created after 3pm PST, it will not be submitted for processing
until <strong>3pm PST</strong> the next business day.</dd>
<dt><span class="docutils literal"><code>succeeded</code></span></dt>
<dd>One business day after the batch submission, the status will change to <span class="docutils literal"><code>succeeded</code></span>
("Paid" in the dashboard). That is the <em>expected</em> status of the credit. If the account number and
routing number were entered correctly, the money should in fact be available to
the seller. However, there is no immediate confirmation regarding the
transaction showing up in the seller's account successfully</dd>
<dt><span class="docutils literal"><code>failed</code></span></dt>
<dd>The seller's bank has up to three business days from when the money
<em>should</em> be available to indicate a rejection along with the rejection reason.
Unfortunately, not all banks comply with ACH network policies and may respond
after three business days with a rejection. As soon as Balanced receives the
rejection, the status is updated to <span class="docutils literal"><code>failed</code></span>
</dd>
</dl></section><hr>
<section id="payout-methods"><h2>Payout Methods<a class="headerlink" href="#payout-methods" title="Permalink to this headline"></a>
</h2>
<p>Currently Balanced only supports payouts to bank accounts via ACH but we will
add more. All of this is publicly tracked via github issues. For example:</p>
<ul class="simple">
<li><a class="reference external" href="https://github.com/balanced/balanced-api/issues/69">Payouts via Check</a></li>
<li><a class="reference external" href="https://github.com/balanced/balanced-api/issues/32">Pushing to Cards</a></li>
</ul>
<p>Comment on those that would be useful to you or create issues for ones you'd
like to see supported!</p>
</section><hr>
<section id="canceling-credits"><h2>Canceling Credits<a class="headerlink" href="#canceling-credits" title="Permalink to this headline"></a>
</h2>
<p>Canceling a credit is currently under active development and discussion on
<a class="reference external" href="https://github.com/balanced/balanced-api/issues/151">github issue #151</a> - it's not very straightforward due to the asynchronous
nature of ACH.</p>
<p>If you require immediately canceling of a credit, please contact us via any
of our <a class="reference internal" href="overview.html#overview-support"><em>support channels</em></a> and we will attempt to cancel the
credit.</p>
<p>When referencing a specific credit, please provide the credit's <span class="docutils literal"><code>uri</code></span> so that
we may quickly proceed with fulfilling your request.</p>
</section><hr>
<section id="pre-funding-your-account"><h2>Pre-funding Your Account<a class="headerlink" href="#pre-funding-your-account" title="Permalink to this headline"></a>
</h2>
<p>Any payout issued requires maintaining sufficient money in your Balanced account.</p>
<p>If you do not have a sufficient balance, Balanced will return a <span class="docutils literal"><code>409</code></span> http
status code, stating that you do not have sufficient funds to cover your
desired ACH operation.</p>
<p>As a result, you will have to add funds from your bank account to your account
via the Balanced <a class="reference external" href="https://dashboard.balancedpayments.com/">dashboard</a>.</p>
<div class="alert alert-tab admonition tip">
tip</div>
<div class="alert alert-gray">
We advise that you transfer a large amount in your Balanced account or you
may request that Balanced always keep a constant amount in your account for
you. We're publicly tracking this on <a class="reference external" href="https://github.com/balanced/balanced-api/issues/132">github issue #132</a> and appreciate your input</div>
<p>Transfers may take 2-5 days for the funds to become available; alternatively, you
may fund your account <strong>instantly</strong> with <a class="reference internal" href="overview.html#processing"><em>Balanced Processing!</em></a></p>
</section><hr>
<section id="submission-delivery-times"><span id="payouts-cutoff"></span><h2>Submission &amp; Delivery times<a class="headerlink" href="#submission-delivery-times" title="Permalink to this headline"></a>
</h2>
<div class="table-header">
The cutoff for submitting payouts is <strong>3:00 PM Pacific (PT)</strong> time. Payouts will <em>not</em> be
delivered on weekends or <a class="reference external" href="http://www.federalreserve.gov/aboutthefed/k8.htm">bank holidays</a>:</div>
<table border="1" class="table table-hover docutils">
<colgroup>
<col width="39%">
<col width="12%">
<col width="12%">
<col width="12%">
<col width="13%">
<col width="12%">
</colgroup>
<thead valign="bottom"><tr class="row-odd">
<th class="head">Holiday</th>
<th class="head">2012</th>
<th class="head">2013</th>
<th class="head">2014</th>
<th class="head">2015</th>
<th class="head">2016</th>
</tr></thead>
<tbody valign="top">
<tr class="row-even">
<td>New Year's Day</td>
<td>January 2</td>
<td>January 1</td>
<td>January 1</td>
<td>January 1</td>
<td>January 1</td>
</tr>
<tr class="row-odd">
<td>Birthday of Martin Luther King, Jr.</td>
<td>January 16</td>
<td>January 21</td>
<td>January 20</td>
<td>January 19</td>
<td>January 18</td>
</tr>
<tr class="row-even">
<td>Washington's Birthday</td>
<td>February 20</td>
<td>February 18</td>
<td>February 17</td>
<td>February 16</td>
<td>February 15</td>
</tr>
<tr class="row-odd">
<td>Memorial Day</td>
<td>May 28</td>
<td>May 27</td>
<td>May 26</td>
<td>May 25</td>
<td>May 30</td>
</tr>
<tr class="row-even">
<td>Independence Day</td>
<td>July 4</td>
<td>July 4</td>
<td>July 4</td>
<td>July 4 <a class="footnote-reference" href="#id2" id="id1">[*]</a>
</td>
<td>July 4</td>
</tr>
<tr class="row-odd">
<td>Labor Day</td>
<td>September 3</td>
<td>September 2</td>
<td>September 1</td>
<td>September 7</td>
<td>September 5</td>
</tr>
<tr class="row-even">
<td>Columbus Day</td>
<td>October 8</td>
<td>October 14</td>
<td>October 13</td>
<td>October 12</td>
<td>October 10</td>
</tr>
<tr class="row-odd">
<td>Veterans Day</td>
<td>November 12</td>
<td>November 11</td>
<td>November 11</td>
<td>November 11</td>
<td>November 11</td>
</tr>
<tr class="row-even">
<td>Thanksgiving Day</td>
<td>November 22</td>
<td>November 28</td>
<td>November 27</td>
<td>November 26</td>
<td>November 24</td>
</tr>
<tr class="row-odd">
<td>Christmas Day</td>
<td>December 25</td>
<td>December 25</td>
<td>December 25</td>
<td>December 25</td>
<td>December 26</td>
</tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id2" rules="none">
<colgroup>
<col class="label">
<col>
</colgroup>
<tbody valign="top"><tr>
<td class="label"><a class="fn-backref" href="#id1">[*]</a></td>
<td>Saturday</td>
</tr></tbody>
</table>
<div class="table-header">
Here's some common scenarios for payouts. Remember, the next-day cut off is
at <strong>3:00 PM Pacific (PT)</strong>.</div>
<table border="1" class="table table-hover docutils">
<colgroup>
<col width="27%">
<col width="47%">
<col width="27%">
</colgroup>
<thead valign="bottom"><tr class="row-odd">
<th class="head">Type of scenario</th>
<th class="head">Example submission date</th>
<th class="head">Available when? <a class="footnote-reference" href="#id4" id="id3">[&acirc;&#128;&nbsp;]</a>
</th>
</tr></thead>
<tbody valign="top">
<tr class="row-even">
<td>Most common</td>
<td>Tuesday @ 1:45PM PT</td>
<td>Wednesday @ 9:00AM PT</td>
</tr>
<tr class="row-odd">
<td><a class="reference external" href="http://www.federalreserve.gov/aboutthefed/k8.htm">Bank holidays</a></td>
<td>July 3rd @ 1:30PM PT</td>
<td>July 5th @ 9:00AM PT</td>
</tr>
<tr class="row-even">
<td>Late submission</td>
<td>Friday @ 3:30PM PT</td>
<td>Tuesday @ 9:00AM PT</td>
</tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id4" rules="none">
<colgroup>
<col class="label">
<col>
</colgroup>
<tbody valign="top"><tr>
<td class="label"><a class="fn-backref" href="#id3">[&acirc;&#128;&nbsp;]</a></td>
<td>Assumes that day is a working business day -- does not fall on a
weekend or a <a class="reference external" href="bankholidays">federal reserve holiday</a>.</td>
</tr></tbody>
</table></section></section><hr>
<span id="document-fees"></span><section id="pricing-and-fees"><span id="fees"></span><h1>Pricing and fees<a class="headerlink" href="#pricing-and-fees" title="Permalink to this headline"></a>
</h1>
<p>You will pay a fee of 25&Acirc;&cent; when you successfully payout to a seller&acirc;&#128;&#153;s
bank account, and 2.9% + 30&Acirc;&cent; when you successfully charge a buyer&acirc;&#128;&#153;s
credit card. We try to keep our pricing straightforward, so Balanced
does not charge any fees besides those listed here.</p>
<hr>
<section id="payout-pricing"><span id="fees-payouts"></span><h2>Payout Pricing<a class="headerlink" href="#payout-pricing" title="Permalink to this headline"></a>
</h2>
<p>It costs just simply 25&Acirc;&cent; to issue a next-day ACH credit. Our full
fee per operation is listed below:</p>
<table border="1" class="table table-hover docutils">
<colgroup>
<col width="65%">
<col width="35%">
</colgroup>
<thead valign="bottom"><tr class="row-odd">
<th class="head">Operation</th>
<th class="head">Cost to you</th>
</tr></thead>
<tbody valign="top">
<tr class="row-even">
<td>next-day ACH</td>
<td>25&Acirc;&cent;</td>
</tr>
<tr class="row-odd">
<td>failure</td>
<td>$1.00</td>
</tr>
<tr class="row-even">
<td>reversal</td>
<td>$0</td>
</tr>
<tr class="row-odd">
<td>batch fee</td>
<td>$0</td>
</tr>
<tr class="row-even">
<td>monthly fee</td>
<td>$0</td>
</tr>
<tr class="row-odd">
<td>set-up fee</td>
<td>$0</td>
</tr>
<tr class="row-even">
<td>payouts to your bank account</td>
<td>$0</td>
</tr>
</tbody>
</table></section><hr>
<section id="processing-pricing"><span id="fees-processing"></span><h2>Processing Pricing<a class="headerlink" href="#processing-pricing" title="Permalink to this headline"></a>
</h2>
<p>Charging credit cards costs just 2.9% and 30&Acirc;&cent; per successful charge. Our full
fees per operation is listed below:</p>
<table border="1" class="table table-hover docutils">
<colgroup>
<col width="63%">
<col width="37%">
</colgroup>
<thead valign="bottom"><tr class="row-odd">
<th class="head">Operation</th>
<th class="head">Cost to you</th>
</tr></thead>
<tbody valign="top">
<tr class="row-even">
<td>successful credit card charge</td>
<td>2.9% + 30&Acirc;&cent; <a class="footnote-reference" href="#id3" id="id1">[1]</a>
</td>
</tr>
<tr class="row-odd">
<td>successful bank account charge</td>
<td>1% + 30&Acirc;&cent; <a class="footnote-reference" href="#id4" id="id2">[2]</a>
</td>
</tr>
<tr class="row-even">
<td>chargeback</td>
<td>$15.00</td>
</tr>
<tr class="row-odd">
<td>refund</td>
<td>$0</td>
</tr>
<tr class="row-even">
<td>failure</td>
<td>$0</td>
</tr>
<tr class="row-odd">
<td>batch fee</td>
<td>$0</td>
</tr>
<tr class="row-even">
<td>monthly fee</td>
<td>$0</td>
</tr>
<tr class="row-odd">
<td>set-up fee</td>
<td>$0</td>
</tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id3" rules="none">
<colgroup>
<col class="label">
<col>
</colgroup>
<tbody valign="top"><tr>
<td class="label"><a class="fn-backref" href="#id1">[1]</a></td>
<td>Includes implicit hold.</td>
</tr></tbody>
</table>
<table class="docutils footnote" frame="void" id="id4" rules="none">
<colgroup>
<col class="label">
<col>
</colgroup>
<tbody valign="top"><tr>
<td class="label"><a class="fn-backref" href="#id2">[2]</a></td>
<td>Fee is capped at $5</td>
</tr></tbody>
</table></section><hr>
<section id="invoicing-fees"><span id="id5"></span><h2>Invoicing fees<a class="headerlink" href="#invoicing-fees" title="Permalink to this headline"></a>
</h2>
<p>Balanced will create invoices to collect fees daily. These invoices can be
viewed under the invoices tab of the Balanced dashboard. These fees are
debited from the bank account attached to the owner account of the
marketplace.</p>
<div class="alert alert-tab admonition note">
note</div>
<div class="alert alert-gray">
<strong>Balanced will never take fees from the operating capital (escrow account) of the marketplace.</strong>
</div>
<section id="example"><h3>Example<a class="headerlink" href="#example" title="Permalink to this headline"></a>
</h3>
<p>A buyer pays for a service on Monday from a third-party merchant. You charge
the buyer $10, which increases your escrow balance by $10. Balanced will invoice
you, on Monday for 2.9% of $10 (or 29&Acirc;&cent;), plus 30&Acirc;&cent;, and debit your bank account
for a total of 59&Acirc;&cent;.</p>
<p>On Wednesday, the third-party merchant completes performing a service for the
buyer, and the buyer acknowledges this. You credit out payment to the
merchant, likely keeping a portion to pay your fees. Perhaps you pay out $7
to the merchant, leaving you with $3 in your escrow account. Balanced will
invoice you, on Wednesday, 25&Acirc;&cent; for this ACH credit.</p>
<p>The $3 that is left from the buyer's $10 is your revenue from this order. You
decide to credit this to your own bank account on Friday. Balanced doesn't
charge you for this credit, as credits to owner accounts are free.</p>
</section></section><hr>
<section id="funds-flow"><h2>Funds Flow<a class="headerlink" href="#funds-flow" title="Permalink to this headline"></a>
</h2>
<p>It's important to understand how the funds flow works on Balanced. First and
foremost, when a charge occurs on Balanced, the amount you've charged your
user is the exact amount that shows up in the balance.</p>
<section id="escrow"><span id="mp-escrow"></span><h3>Escrow<a class="headerlink" href="#escrow" title="Permalink to this headline"></a>
</h3>
<p>Once a card is successfully charged your funds are implicitly in escrow for
your marketplace. This gives you complete control on funds disbursement.</p>
<p>You may choose to keep the money in escrow for as long as you desire
- but the common use case for this is to wait for any type of fulfillment
from your merchants -- such as confirmation of a shipped product or
completion of a service.</p>
<p>Since <a class="reference internal" href="overview.html#payouts"><em>Balanced Payouts</em></a> delivers funds to your merchant within
one (1) business day, you can get a bit more creative as well. For example,
you may stagger the funds for disbursement at different times during the order
process - for example:</p>
<ul class="simple">
<li>A buyer has paid for a service</li>
<li>Your merchant needs half of the payout amount as working capital</li>
<li>You issue 50% of the amount you charged the buyer as a credit to the merchant
using <a class="reference internal" href="overview.html#payouts"><em>Balanced Payouts</em></a>
</li>
<li>The merchant performs the service and buyer is happy with the service</li>
<li>You can pay the other half post completion of the service</li>
</ul>
<p>In today's growing collaborative consumption economy, this model is extremely
powerful for providing marketplace liquidity to enable new forms of commerce.</p>
</section><section id="collecting-your-fees"><h3>Collecting Your Fees<a class="headerlink" href="#collecting-your-fees" title="Permalink to this headline"></a>
</h3>
<p>Now that you've understood how incoming money comes in to Balanced and the
concept of implicit escrow, you might ask yourself, "where do I take my
cut?" Since incoming funds are not touched by Balanced, you must issue a credit
to your own bank account with the funds you want for yourself -- that means you
must do the math to calculate the difference.</p>
<p>There are three common scenarios:</p>
<ol class="arabic simple">
<li>with-holding some of the funds from the merchant and diverting those funds to yourself</li>
</ol>
<ol class="arabic simple" start="2">
<li>adding your business' fee to the total amount charged during checkout</li>
</ol>
<ol class="arabic simple" start="3">
<li>doing both of these :)</li>
</ol>
<p>Here are some examples that can clarify these scenarios, but first let's give
a little context:</p>
<p>Let's say you have a marketplace called <strong>RentMyBike</strong> <a class="footnote-reference" href="#id7" id="id6">[3]</a>, which provides
a platform for bike owners, a.k.a. merchants, to put their bikes for rent by
renters, a.k.a. the buyers.</p>
<p>Recap:</p>
<ul class="simple">
<li>The bike owners are the merchants.</li>
<li>The renters are the buyers.</li>
<li>Your marketplace is called Rent My Bike</li>
</ul>
<table class="docutils footnote" frame="void" id="id7" rules="none">
<colgroup>
<col class="label">
<col>
</colgroup>
<tbody valign="top"><tr>
<td class="label"><a class="fn-backref" href="#id6">[3]</a></td>
<td>Our sample marketplace is actually called <a class="reference external" href="http://rentmybike.heroku.com">Rent My Bike</a> :)</td>
</tr></tbody>
</table></section><section id="fee-scenario-1"><h3>Fee Scenario #1<a class="headerlink" href="#fee-scenario-1" title="Permalink to this headline"></a>
</h3>
<p>Your marketplace listing fee is 10%. So, say Alice lists her bike for $100.00.
Bob decides to rent this bike - costing him $100.00.</p>
<ul class="simple">
<li>You charge Bob $100.00</li>
<li>Your  balance now shows $100.00</li>
<li>Alice delivers the bike to Bob</li>
<li>You issue a $90.00 credit to Alice, using <a class="reference internal" href="overview.html#payouts"><em>Balanced Payouts</em></a><ul>
<li>Your listing fee is 10%, so 90% of $100.00 is $90.00</li>
</ul>
</li>
<li>Your marketplace's <a class="reference external" href="https://dashboard.balancedpayments.com/#/marketplaces/">dashboard</a> escrow balance now shows $10.00</li>
<li>You issue a credit to your own bank account, using <a class="reference internal" href="overview.html#payouts"><em>Balanced Payouts</em></a>
</li>
<li>Your money is in your bank account next business day</li>
<li>Alice's money is in her bank account next business day</li>
<li>Your marketplace's <a class="reference external" href="https://dashboard.balancedpayments.com/#/marketplaces/">dashboard</a> escrow balance now shows $0.00</li>
</ul></section><section id="fee-scenario-2"><h3>Fee Scenario #2<a class="headerlink" href="#fee-scenario-2" title="Permalink to this headline"></a>
</h3>
<p>Your marketplace renting fee is 10%. So, say Alice lists her bike for 100.00$.
Bob decides to rent this bike - costing him $110.00.</p>
<ul class="simple">
<li>You charge Bob $110.00<ul>
<li>Your renting fee is 10%, so $100.00 * 1.10 = $110.00 is how much to charge Bob</li>
</ul>
</li>
<li>Your marketplace's <a class="reference external" href="https://dashboard.balancedpayments.com/#/marketplaces/">dashboard</a> escrow balance now shows $110.00</li>
<li>Alice delivers the bike to Bob</li>
<li>You issue a $100.00 credit to Alice, using <a class="reference internal" href="overview.html#payouts"><em>Balanced Payouts</em></a>
</li>
<li>Your marketplace's <a class="reference external" href="https://dashboard.balancedpayments.com/#/marketplaces/">dashboard</a> escrow balance now shows $10.00</li>
<li>You issue a credit for $10.00 to your own bank account, using <a class="reference internal" href="overview.html#payouts"><em>Balanced Payouts</em></a>
</li>
<li>Your money is in your bank account next business day</li>
<li>Alice's money is in her bank account next business day</li>
<li>Your marketplace's <a class="reference external" href="https://dashboard.balancedpayments.com/#/marketplaces/">dashboard</a> escrow balance now shows $0.00</li>
</ul></section><section id="fee-scenario-3"><h3>Fee Scenario #3<a class="headerlink" href="#fee-scenario-3" title="Permalink to this headline"></a>
</h3>
<p>Your marketplace renting fee is 10%. You also charge a 10% listing fee.</p>
<p>So, say Alice lists her bike for 100.00$. Bob decides to rent this
bike - costing him $110.00.</p>
<ul class="simple">
<li>You charge Bob $110.00<ul>
<li>Your renting fee is 10%, so $100.00 * 1.10 = $110.00 is how much to charge Bob</li>
</ul>
</li>
<li>Your marketplace's <a class="reference external" href="https://dashboard.balancedpayments.com/#/marketplaces/">dashboard</a> escrow balance now shows $110.00</li>
<li>Alice delivers the bike to Bob</li>
<li>You issue a $90.00 credit to Alice, using <a class="reference internal" href="overview.html#payouts"><em>Balanced Payouts</em></a><ul>
<li>Your listing fee is 10%, so 90% of $100.00 is $90.00</li>
</ul>
</li>
<li>Your marketplace's <a class="reference external" href="https://dashboard.balancedpayments.com/#/marketplaces/">dashboard</a> escrow balance now shows $20.00</li>
<li>You issue a credit for $20.00 to your own bank account, using <a class="reference internal" href="overview.html#payouts"><em>Balanced Payouts</em></a>
</li>
<li>Your money is in your bank account next business day</li>
<li>Alice's money is in her bank account next business day</li>
<li>Your marketplace's <a class="reference external" href="https://dashboard.balancedpayments.com/#/marketplaces/">dashboard</a> escrow balance now shows $0.00</li>
</ul></section></section></section><hr>
<span id="document-resources"></span><section id="resources"><span id="id1"></span><h1>Resources<a class="headerlink" href="#resources" title="Permalink to this headline"></a>
</h1>
<hr>
<section id="test-credit-card-numbers"><span id="resources-test-credit-cards"></span><h2>Test credit card numbers<a class="headerlink" href="#test-credit-card-numbers" title="Permalink to this headline"></a>
</h2>
<p>These cards will be accepted in our system only for a <strong>TEST</strong> marketplace.</p>
<table border="1" class="table docutils">
<colgroup>
<col width="16%">
<col width="31%">
<col width="18%">
<col width="34%">
</colgroup>
<thead valign="bottom"><tr class="row-odd">
<th class="head">Card Brand</th>
<th class="head">Number</th>
<th class="head">Security Code</th>
<th class="head">Result</th>
</tr></thead>
<tbody valign="top">
<tr class="row-even">
<td><span class="docutils literal"><code>VISA</code></span></td>
<td><span class="docutils literal"><code>4111111111111111</code></span></td>
<td><span class="docutils literal"><code>123</code></span></td>
<td>SUCCESS</td>
</tr>
<tr class="row-odd">
<td><span class="docutils literal"><code>MasterCard</code></span></td>
<td><span class="docutils literal"><code>5105105105105100</code></span></td>
<td><span class="docutils literal"><code>123</code></span></td>
<td>SUCCESS</td>
</tr>
<tr class="row-even">
<td><span class="docutils literal"><code>AMEX</code></span></td>
<td><span class="docutils literal"><code>341111111111111</code></span></td>
<td><span class="docutils literal"><code>1234</code></span></td>
<td>SUCCESS</td>
</tr>
<tr class="row-odd">
<td><span class="docutils literal"><code>VISA</code></span></td>
<td>
<span class="docutils literal"><code>4444444444444448</code></span> <a class="footnote-reference" href="#id4" id="id2">[1]</a>
</td>
<td><span class="docutils literal"><code>123</code></span></td>
<td>SIMULATE PROCESSOR FAILURE</td>
</tr>
<tr class="row-even">
<td><span class="docutils literal"><code>VISA</code></span></td>
<td>
<span class="docutils literal"><code>4222222222222220</code></span> <a class="footnote-reference" href="#id5" id="id3">[2]</a>
</td>
<td><span class="docutils literal"><code>123</code></span></td>
<td>SIMULATE TOKENIZATION ERROR</td>
</tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id4" rules="none">
<colgroup>
<col class="label">
<col>
</colgroup>
<tbody valign="top"><tr>
<td class="label"><a class="fn-backref" href="#id2">[1]</a></td>
<td>Simulate a card which can be tokenized but will not be accepted for creating
holds or debits. This type of failure is what you would expect if you try to
create a hold on a card with insufficient funds.</td>
</tr></tbody>
</table>
<table class="docutils footnote" frame="void" id="id5" rules="none">
<colgroup>
<col class="label">
<col>
</colgroup>
<tbody valign="top"><tr>
<td class="label"><a class="fn-backref" href="#id3">[2]</a></td>
<td>To simulate a card which cannot be tokenized but passes a LUHN check. You could
expect this failure when a user tried to enter in a credit card which used to
work but has been canceled.</td>
</tr></tbody>
</table></section><hr>
<section id="test-bank-account-numbers"><span id="resources-test-bank-accounts"></span><h2>Test bank account numbers<a class="headerlink" href="#test-bank-account-numbers" title="Permalink to this headline"></a>
</h2>
<p>Balanced provides various utilities to aid you in testing your <a class="reference internal" href="overview.html#payouts"><em>Balanced Payouts</em></a>
integration.</p>
<p>When integrating payouts, it's worth noting that incorrect bank routing numbers
are a very commonly encountered error as Balanced does real-time checks against
the <a class="reference external" href="https://www.fededirectory.frb.org">FedACH directory</a>.</p>
<p>To aid you while integrating, Balanced provides special routing and
account numbers that can simulate various scenarios that can go wrong.</p>
<table border="1" class="table docutils">
<colgroup>
<col width="20%">
<col width="27%">
<col width="53%">
</colgroup>
<thead valign="bottom"><tr class="row-odd">
<th class="head">Routing Number</th>
<th class="head">Account Number</th>
<th class="head">Scenario</th>
</tr></thead>
<tbody valign="top">
<tr class="row-even">
<td><span class="docutils literal"><code>100000007</code></span></td>
<td><span class="docutils literal"><code>8887776665555</code></span></td>
<td>Invalid Routing Number</td>
</tr>
<tr class="row-odd">
<td><span class="docutils literal"><code>111111118</code></span></td>
<td><span class="docutils literal"><code>8887776665555</code></span></td>
<td>Invalid Routing Number</td>
</tr>
<tr class="row-even">
<td><span class="docutils literal"><code>021000021</code></span></td>
<td><span class="docutils literal"><code>9900000000</code></span></td>
<td>Transitions state to <span class="docutils literal"><code>pending</code></span>
</td>
</tr>
<tr class="row-odd">
<td><span class="docutils literal"><code>321174851</code></span></td>
<td><span class="docutils literal"><code>9900000001</code></span></td>
<td>Transitions state to <span class="docutils literal"><code>pending</code></span>
</td>
</tr>
<tr class="row-even">
<td><span class="docutils literal"><code>021000021</code></span></td>
<td><span class="docutils literal"><code>9900000002</code></span></td>
<td>Transitions state to <span class="docutils literal"><code>paid</code></span> (credits) or <span class="docutils literal"><code>succeeded</code></span> (debits)</td>
</tr>
<tr class="row-odd">
<td><span class="docutils literal"><code>321174851</code></span></td>
<td><span class="docutils literal"><code>9900000003</code></span></td>
<td>Transitions state to <span class="docutils literal"><code>paid</code></span> (credits) or <span class="docutils literal"><code>succeeded</code></span> (debits)</td>
</tr>
<tr class="row-even">
<td><span class="docutils literal"><code>021000021</code></span></td>
<td><span class="docutils literal"><code>9900000004</code></span></td>
<td>Transitions state to <span class="docutils literal"><code>failed</code></span>
</td>
</tr>
<tr class="row-odd">
<td><span class="docutils literal"><code>321174851</code></span></td>
<td><span class="docutils literal"><code>9900000005</code></span></td>
<td>Transitions state to <span class="docutils literal"><code>failed</code></span>
</td>
</tr>
</tbody>
</table>
<section id="simulating-erroneous-routing-numbers"><h3>Simulating erroneous routing numbers<a class="headerlink" href="#simulating-erroneous-routing-numbers" title="Permalink to this headline"></a>
</h3>
<div class="request">
<p>Request</p>


<div class="highlight-ruby">
<div class="highlight"><pre><span class="nb">require</span> <span class="s1">'balanced'</span>
<span class="no">Balanced</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s1">'ak-test-1p1Tsac7gHeMQowL2seB7ieliuAJAufyq'</span><span class="p">)</span>

<span class="n">bank_account</span> <span class="o">=</span> <span class="no">Balanced</span><span class="o">::</span><span class="no">BankAccount</span><span class="o">.</span><span class="n">new</span><span class="p">(</span>
  <span class="ss">:uri</span> <span class="o">=&gt;</span> <span class="s1">'/v1/marketplaces/TEST-MP5FKPQwyjvVgTDt7EiRw3Kq/bank_accounts'</span><span class="p">,</span>
  <span class="ss">:account_number</span> <span class="o">=&gt;</span> <span class="s1">'9900000001'</span><span class="p">,</span>
  <span class="ss">:name</span> <span class="o">=&gt;</span> <span class="s1">'Johann Bernoulli'</span><span class="p">,</span>
  <span class="ss">:routing_number</span> <span class="o">=&gt;</span> <span class="s1">'100000007'</span><span class="p">,</span>
  <span class="ss">:type</span> <span class="o">=&gt;</span> <span class="s1">'checking'</span>
<span class="p">)</span>

<span class="k">begin</span>
  <span class="n">bank_account</span><span class="o">.</span><span class="n">save</span>
<span class="k">rescue</span> <span class="no">Balanced</span><span class="o">::</span><span class="no">BadRequest</span> <span class="o">=&gt;</span> <span class="n">ex</span>
  <span class="k">raise</span> <span class="s2">"Key is not returned!"</span> <span class="k">unless</span> <span class="n">ex</span><span class="o">.</span><span class="n">extras</span><span class="o">.</span><span class="n">has_key?</span> <span class="s2">"routing_number"</span>
<span class="k">end</span>
</pre></div>
</div>


</div>
</section><section id="simulating-a-pending-status"><h3>Simulating a pending status<a class="headerlink" href="#simulating-a-pending-status" title="Permalink to this headline"></a>
</h3>
<div class="request">
<p>Request</p>


<div class="highlight-ruby">
<div class="highlight"><pre><span class="nb">require</span> <span class="s1">'balanced'</span>
<span class="no">Balanced</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s1">'ak-test-1p1Tsac7gHeMQowL2seB7ieliuAJAufyq'</span><span class="p">)</span>

<span class="n">bank_account_info</span> <span class="o">=</span> <span class="p">{</span>
  <span class="ss">:account_number</span> <span class="o">=&gt;</span> <span class="s1">'9900000001'</span><span class="p">,</span>
  <span class="ss">:name</span> <span class="o">=&gt;</span> <span class="s1">'Johann Bernoulli'</span><span class="p">,</span>
  <span class="ss">:routing_number</span> <span class="o">=&gt;</span> <span class="s1">'121000358'</span><span class="p">,</span>
  <span class="ss">:type</span> <span class="o">=&gt;</span> <span class="s1">'checking'</span>
<span class="p">}</span>

<span class="n">credit</span> <span class="o">=</span> <span class="no">Balanced</span><span class="o">::</span><span class="no">Credit</span><span class="o">.</span><span class="n">new</span><span class="p">(</span>
  <span class="ss">:amount</span> <span class="o">=&gt;</span> <span class="mi">10000</span><span class="p">,</span>
  <span class="ss">:bank_account</span> <span class="o">=&gt;</span> <span class="n">bank_account_info</span>
<span class="p">)</span><span class="o">.</span><span class="n">save</span>
</pre></div>
</div>


</div>
</section><section id="simulating-a-paid-status"><h3>Simulating a paid status<a class="headerlink" href="#simulating-a-paid-status" title="Permalink to this headline"></a>
</h3>
<div class="request">
<p>Request</p>


<div class="highlight-ruby">
<div class="highlight"><pre><span class="nb">require</span> <span class="s1">'balanced'</span>
<span class="no">Balanced</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s1">'ak-test-1p1Tsac7gHeMQowL2seB7ieliuAJAufyq'</span><span class="p">)</span>

<span class="n">marketplace</span> <span class="o">=</span> <span class="no">Balanced</span><span class="o">::</span><span class="no">Marketplace</span><span class="o">.</span><span class="n">my_marketplace</span>

<span class="n">bank_account_info</span> <span class="o">=</span> <span class="p">{</span>
  <span class="ss">:account_number</span> <span class="o">=&gt;</span> <span class="s1">'9900000002'</span><span class="p">,</span>
  <span class="ss">:name</span> <span class="o">=&gt;</span> <span class="s1">'Johann Bernoulli'</span><span class="p">,</span>
  <span class="ss">:routing_number</span> <span class="o">=&gt;</span> <span class="s1">'121000358'</span><span class="p">,</span>
  <span class="ss">:type</span> <span class="o">=&gt;</span> <span class="s1">'checking'</span>
<span class="p">}</span>

<span class="n">credit</span> <span class="o">=</span> <span class="no">Balanced</span><span class="o">::</span><span class="no">Credit</span><span class="o">.</span><span class="n">new</span><span class="p">(</span>
  <span class="ss">:amount</span> <span class="o">=&gt;</span> <span class="mi">10000</span><span class="p">,</span>
  <span class="ss">:bank_account</span> <span class="o">=&gt;</span> <span class="n">bank_account_info</span>
<span class="p">)</span><span class="o">.</span><span class="n">save</span>
</pre></div>
</div>


</div>
</section><section id="simulating-a-failed-status"><h3>Simulating a failed status<a class="headerlink" href="#simulating-a-failed-status" title="Permalink to this headline"></a>
</h3>
<div class="request">
<p>Request</p>


<div class="highlight-ruby">
<div class="highlight"><pre><span class="nb">require</span> <span class="s1">'balanced'</span>
<span class="no">Balanced</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s1">'ak-test-1p1Tsac7gHeMQowL2seB7ieliuAJAufyq'</span><span class="p">)</span>

<span class="n">marketplace</span> <span class="o">=</span> <span class="no">Balanced</span><span class="o">::</span><span class="no">Marketplace</span><span class="o">.</span><span class="n">my_marketplace</span>

<span class="n">bank_account_info</span> <span class="o">=</span> <span class="p">{</span>
  <span class="ss">:account_number</span> <span class="o">=&gt;</span> <span class="s1">'9900000005'</span><span class="p">,</span>
  <span class="ss">:name</span> <span class="o">=&gt;</span> <span class="s1">'Johann Bernoulli'</span><span class="p">,</span>
  <span class="ss">:routing_number</span> <span class="o">=&gt;</span> <span class="s1">'121000358'</span><span class="p">,</span>
  <span class="ss">:type</span> <span class="o">=&gt;</span> <span class="s1">'checking'</span>
<span class="p">}</span>
<span class="n">credit</span> <span class="o">=</span> <span class="no">Balanced</span><span class="o">::</span><span class="no">Credit</span><span class="o">.</span><span class="n">new</span><span class="p">(</span>
  <span class="ss">:amount</span> <span class="o">=&gt;</span> <span class="mi">10000</span><span class="p">,</span>
  <span class="ss">:bank_account</span> <span class="o">=&gt;</span> <span class="n">bank_account_info</span>
<span class="p">)</span><span class="o">.</span><span class="n">save</span>
</pre></div>
</div>


</div>
</section></section><hr>
<section id="test-identity-verification"><span id="resources-test-identity-verification"></span><h2>Test identity verification<a class="headerlink" href="#test-identity-verification" title="Permalink to this headline"></a>
</h2>
<p><span class="docutils literal"><code>Customer</code></span> resources have an <span class="docutils literal"><code>is_identity_verified</code></span> attribute.</p>
<p>Omit address data to trigger a <span class="docutils literal"><code>false</code></span> response. Supply address data
to trigger a <span class="docutils literal"><code>true</code></span> response.</p>
<p>The following will set <span class="docutils literal"><code>is_identity_verified</code></span> to <span class="docutils literal"><code>true</code></span></p>
<div class="highlight-javascript">
<div class="highlight"><pre><span class="p">{</span>
    <span class="s1">'name'</span><span class="o">:</span> <span class="s1">'Henry Ford'</span><span class="p">,</span>
    <span class="s1">'dob'</span><span class="o">:</span> <span class="s1">'1863-07'</span><span class="p">,</span>
    <span class="s1">'address'</span><span class="o">:</span> <span class="p">{</span>
        <span class="s1">'postal_code'</span><span class="o">:</span> <span class="s1">'48120'</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The following will set <span class="docutils literal"><code>is_identity_verified</code></span> to <span class="docutils literal"><code>false</code></span></p>
<div class="highlight-javascript">
<div class="highlight"><pre><span class="p">{</span>
    <span class="s1">'name'</span><span class="o">:</span> <span class="s1">'Henry Ford'</span><span class="p">,</span>
    <span class="s1">'dob'</span><span class="o">:</span> <span class="s1">'1863-07'</span>
<span class="p">}</span>
</pre></div>
</div>
</section><hr>
<section id="request-logs"><span id="resources-request-logs"></span><h2>Request Logs<a class="headerlink" href="#request-logs" title="Permalink to this headline"></a>
</h2>
<p>As you integrate and test <a class="reference internal" href="overview.html#payouts"><em>Balanced Payouts</em></a>, you may find it useful to view
all your sanitized API request logs. They are viewable via the logs section
in the <a class="reference external" href="https://dashboard.balancedpayments.com/">dashboard</a></p>
</section><hr>
<section id="the-hash-attribute"><h2>The Hash Attribute<a class="headerlink" href="#the-hash-attribute" title="Permalink to this headline"></a>
</h2>
<p>Every <span class="docutils literal"><code>Card</code></span> and <span class="docutils literal"><code>BankAccount</code></span> resource has an attribute than can be used
to check if the same card is being added again.</p>
<p>For credit cards, this is the <span class="docutils literal"><code>hash</code></span> attribute. This is calculated using
<span class="docutils literal"><code>card_number</code></span> and the expiration.</p>
<p>For bank accounts, this is the <span class="docutils literal"><code>fingerprint</code></span> attribute. This is calculated using
<span class="docutils literal"><code>account_number</code></span>, <span class="docutils literal"><code>routing_number</code></span>, <span class="docutils literal"><code>name</code></span>, and <span class="docutils literal"><code>type</code></span>.</p>
</section><hr>
<section id="address-verification-service"><span id="resources-address-verification-service"></span><h2>Address Verification Service<a class="headerlink" href="#address-verification-service" title="Permalink to this headline"></a>
</h2>
<p>AVS, <strong>A</strong>ddress <strong>V</strong>erification <strong>S</strong>ervice, provides a means to
verify that the postal_code supplied during card tokenization matches the
billing zip code of the credit card.</p>
<p>Supplying a <span class="docutils literal"><code>postal_code</code></span> during tokenization initiates the AVS check.
The <span class="docutils literal"><code>Card</code></span> will have a <span class="docutils literal"><code>postal_code_check</code></span> attribute containing the
AVS check result.</p>
<p><span class="docutils literal"><code>postal_code_check</code></span> will be one of: <span class="docutils literal"><code>passed</code></span>, <span class="docutils literal"><code>failed</code></span>, <span class="docutils literal"><code>unknown</code></span></p>
</section><hr>
<section id="card-security-code"><span id="resources-card-security-code"></span><h2>Card Security Code<a class="headerlink" href="#card-security-code" title="Permalink to this headline"></a>
</h2>
<p>CSC, <strong>C</strong>ard <strong>S</strong>ecurity <strong>C</strong>ode, provides a means to verify that the
<span class="docutils literal"><code>security_code</code></span> supplied during card tokenization matches the security_code
for the credit card. The <span class="docutils literal"><code>Card</code></span> will have a <span class="docutils literal"><code>security_code_check</code></span>
attribute containing the CSC check result. It's strongly recommended you do
not process transactions with cards that fail this check.</p>
<p><span class="docutils literal"><code>security_code_check</code></span> will be one of: <span class="docutils literal"><code>passed</code></span>, <span class="docutils literal"><code>failed</code></span>, <span class="docutils literal"><code>unknown</code></span></p>
</section></section><hr>
</div>

</div>

    </div>
</div></div>
  <script type="text/javascript" src="static/js/compiled.js"></script>
</div>
